


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../examples/5%20DFL%20methods%20for%20non-specific%20optimization%20models.html">
      
      
      
      <link rel="icon" href="">
    
    
      
        <title>PyDFLT - PyDFLT  documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8071119b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.dataset.DFLDataset" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="PyDFLT  documentation" class="md-header__button md-logo" aria-label="PyDFLT  documentation" data-md-component="logo">
      <img src="../_static/logo_small.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyDFLT  documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PyDFLT
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PyDFLT/PyDFLT/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PyDFLT
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="PyDFLT  documentation" class="md-nav__button md-logo" aria-label="PyDFLT  documentation" data-md-component="logo">
      <img src="../_static/logo_small.png" alt="logo">
    </a>
    PyDFLT  documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PyDFLT/PyDFLT/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PyDFLT
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    <span>Examples</span>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            <span>Examples</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/1%20The%20structure%20of%20PyDFLT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/1 the structure of pydflt.ipynb (reference label)"><span>1 The structure of Py<wbr>DFLT</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/2%20Running%20experiments%20using%20registries.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/2 running experiments using registries.ipynb (reference label)"><span>2 Running experiments using registries</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/3%20Analyzing%20training%20using%20Weights%20and%20Biases.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/3 analyzing training using weights and biases.ipynb (reference label)"><span>3 Analyzing training using Weights and Biases</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/4%20Hyperparameter%20tuning%20using%20Optuna.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/4 hyperparameter tuning using optuna.ipynb (reference label)"><span>4 Hyperparamater tuning using Optuna</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/5%20DFL%20methods%20for%20non-specific%20optimization%20models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/5 dfl methods for non-specific optimization models.ipynb (reference label)"><span>5 DFL methods for non-<wbr>specific optimization models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    <span>API reference</span>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <span>API reference</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/api/src.rst (reference label)"><span>Py<wbr>DFLT</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/api/src.rst (reference label)"><span>Py<wbr>DFLT</span></span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.dataset.DFLDataset" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.dataset.DFLDataset (Python class) — DFLDataset class extends PyTorch&#39;s Dataset for decision-focused learning (DFL) scenarios."><span>DFLDataset</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.logger.Logger" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.logger.Logger (Python class) — A comprehensive logging class for machine learning experiments, integrating with Weights &amp; Biases and managing local log files. It aggregates per-batch results into epoch-level metrics. See src.utils for method load_log for loading logs."><span>Logger</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.noisifier.Noisifier" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.noisifier.Noisifier (Python class) — A class that adds noise to the output of a base predictor."><span>Noisifier</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.problem.Problem" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.problem.Problem (Python class) — Manages a decision-focused learning (DFL) problem encapsulating the dataset (DFLDataset) and an optimization model (OptimizationModel). It is responsible for:"><span>Problem</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.runner.Runner" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.runner.Runner (Python class) — The Runner class allows for running experiments. It uses the given DecisionMaker to run the experiments with and initializes a Logger to log results. It handles the training and evaluation process, including logging, early stopping, and saving the best models found so far."><span>Runner</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.decision_makers.base.DecisionMaker" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.decision_makers.base.DecisionMaker (Python class) — Abstract base class for a decision-making agent in a decision-focused learning pipeline."><span>Decision<wbr>Maker</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.predictors.base.Predictor" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.predictors.base.Predictor (Python class) — Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module."><span>Predictor</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.dataset.DFLDataset" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.dataset.DFLDataset (Python class) — DFLDataset class extends PyTorch&#39;s Dataset for decision-focused learning (DFL) scenarios."><span>DFLDataset</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.logger.Logger" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.logger.Logger (Python class) — A comprehensive logging class for machine learning experiments, integrating with Weights &amp; Biases and managing local log files. It aggregates per-batch results into epoch-level metrics. See src.utils for method load_log for loading logs."><span>Logger</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.noisifier.Noisifier" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.noisifier.Noisifier (Python class) — A class that adds noise to the output of a base predictor."><span>Noisifier</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.problem.Problem" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.problem.Problem (Python class) — Manages a decision-focused learning (DFL) problem encapsulating the dataset (DFLDataset) and an optimization model (OptimizationModel). It is responsible for:"><span>Problem</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.runner.Runner" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.runner.Runner (Python class) — The Runner class allows for running experiments. It uses the given DecisionMaker to run the experiments with and initializes a Logger to log results. It handles the training and evaluation process, including logging, early stopping, and saving the best models found so far."><span>Runner</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.decision_makers.base.DecisionMaker" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.decision_makers.base.DecisionMaker (Python class) — Abstract base class for a decision-making agent in a decision-focused learning pipeline."><span>Decision<wbr>Maker</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.predictors.base.Predictor" class="md-nav__link">
    
      <span aria-label="Python class" class="objinfo-icon objinfo-icon__data" title="Python class">C</span>
    
    <span class="md-ellipsis">
      <span title="src.predictors.base.Predictor (Python class) — Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module."><span>Predictor</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="module-src.dataset"><span id="pydflt"></span><span id="module-src"></span>PyDFLT<a class="headerlink" href="#module-src.dataset" title="Link to this heading">¶</a></h1>
<dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.dataset.DFLDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DFLDataset</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.dataset.DFLDataset" title="src.dataset.DFLDataset.__init__.data_dict (Python parameter)"><span class="n"><span class="pre">data_dict</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.dataset.DFLDataset" title="Link to this definition">¶</a></dt>
<dd><p>DFLDataset class extends PyTorch’s Dataset for decision-focused learning (DFL) scenarios.</p>
<p>It manages a dictionary of data (<cite>data_dict</cite>) where keys represent different quantities
(e.g., ‘features’, ‘costs’, ‘weights’, ‘optimal_decision’) and values are torch.Tensors.
The class ensures that all data tensors have the same number of samples (first dimension)
and are at least 2D. It provides methods to access data by index and to add new data.</p>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.dataset.DFLDataset.data_dict">
<span class="sig-name descname"><span class="pre">data_dict</span></span><a class="headerlink" href="#src.dataset.DFLDataset.data_dict" title="Link to this definition">¶</a></dt>
<dd><p>The core dictionary holding all dataset components.
Keys are strings identifying the data type (e.g., ‘features’, ‘costs’),
and values are torch.Tensors. All tensors are guaranteed to have the same
number of samples in their first dimension and are at least 2D.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.dataset.DFLDataset.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><a class="headerlink" href="#src.dataset.DFLDataset.keys" title="Link to this definition">¶</a></dt>
<dd><p>A list of keys currently present in <cite>data_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.dataset.DFLDataset.num_samples">
<span class="sig-name descname"><span class="pre">num_samples</span></span><a class="headerlink" href="#src.dataset.DFLDataset.num_samples" title="Link to this definition">¶</a></dt>
<dd><p>The number of samples in the dataset, determined from the
first dimension of the tensors in <cite>data_dict</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_data</span></code>(key, data)</p></td>
<td><p>Adds new data component(s) to the dataset.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.logger"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.logger.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.experiment_name (Python parameter)"><span class="n"><span class="pre">experiment_name</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.project_name (Python parameter)"><span class="n"><span class="pre">project_name</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.config (Python parameter)"><span class="n"><span class="pre">config</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.use_wandb (Python parameter)"><span class="n"><span class="pre">use_wandb</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.experiments_folder (Python parameter)"><span class="n"><span class="pre">experiments_folder</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;results/&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.main_metric (Python parameter)"><span class="n"><span class="pre">main_metric</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;abs_regret&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.logger.Logger" title="src.logger.Logger.__init__.store_min_and_max (Python parameter)"><span class="n"><span class="pre">store_min_and_max</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.logger.Logger" title="Link to this definition">¶</a></dt>
<dd><p>A comprehensive logging class for machine learning experiments, integrating with Weights &amp; Biases
and managing local log files. It aggregates per-batch results into epoch-level metrics. See src.utils for method
load_log for loading logs.</p>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.experiment_name">
<span class="sig-name descname"><span class="pre">experiment_name</span></span><a class="headerlink" href="#src.logger.Logger.experiment_name" title="Link to this definition">¶</a></dt>
<dd><p>The name of the current experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.project_name">
<span class="sig-name descname"><span class="pre">project_name</span></span><a class="headerlink" href="#src.logger.Logger.project_name" title="Link to this definition">¶</a></dt>
<dd><p>The name of the project.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.logger.Logger.config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration dictionary for WandB.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Any</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.path_to_log">
<span class="sig-name descname"><span class="pre">path_to_log</span></span><a class="headerlink" href="#src.logger.Logger.path_to_log" title="Link to this definition">¶</a></dt>
<dd><p>The Path object pointing to the directory where logs are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.log_file_path">
<span class="sig-name descname"><span class="pre">log_file_path</span></span><a class="headerlink" href="#src.logger.Logger.log_file_path" title="Link to this definition">¶</a></dt>
<dd><p>The Path object pointing to the text log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Path</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.store_min_and_max">
<span class="sig-name descname"><span class="pre">store_min_and_max</span></span><a class="headerlink" href="#src.logger.Logger.store_min_and_max" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether to store min and max for metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.use_wandb">
<span class="sig-name descname"><span class="pre">use_wandb</span></span><a class="headerlink" href="#src.logger.Logger.use_wandb" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether Weights &amp; Biases is being used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.epoch_metrics_list">
<span class="sig-name descname"><span class="pre">epoch_metrics_list</span></span><a class="headerlink" href="#src.logger.Logger.epoch_metrics_list" title="Link to this definition">¶</a></dt>
<dd><p>A list storing dictionaries of aggregated
metrics for each epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>List</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.logging_keys">
<span class="sig-name descname"><span class="pre">logging_keys</span></span><a class="headerlink" href="#src.logger.Logger.logging_keys" title="Link to this definition">¶</a></dt>
<dd><p>A set of all metric keys encountered across epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><em>set</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.logger.Logger.main_metric">
<span class="sig-name descname"><span class="pre">main_metric</span></span><a class="headerlink" href="#src.logger.Logger.main_metric" title="Link to this definition">¶</a></dt>
<dd><p>The name of the main metric used for returning values from <cite>log_epoch_results</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">finish</span></code>()</p></td>
<td><p>Finishes the Weights &amp; Biases run if it was initialized.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_epoch_results</span></code>(per_batch_results, epoch_num)</p></td>
<td><p>Receives a list of dictionaries with per-batch results, aggregates them, and logs.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">printout</span></code>()</p></td>
<td><p>Utility function that prints out the aggregated epoch results to the console.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.noisifier"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.noisifier.Noisifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Noisifier</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.base_predictor (Python parameter)"><span class="n"><span class="pre">base_predictor</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor (Python class) — Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module."><span class="pre">Predictor</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.bias (Python parameter)"><span class="n"><span class="pre">bias</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.sigma_setting (Python parameter)"><span class="n"><span class="pre">sigma_setting</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;independent&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.sigma_init (Python parameter)"><span class="n"><span class="pre">sigma_init</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mi">1</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.sigma_final (Python parameter)"><span class="n"><span class="pre">sigma_final</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mf">0.1</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.total_steps_cooling (Python parameter)"><span class="n"><span class="pre">total_steps_cooling</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mi">100</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.cooling_type (Python parameter)"><span class="n"><span class="pre">cooling_type</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;linear&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier.__init__.log_normal (Python parameter)"><span class="n"><span class="pre">log_normal</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.noisifier.Noisifier" title="Link to this definition">¶</a></dt>
<dd><p>A class that adds noise to the output of a base predictor.</p>
<p>The Noisifier can operate in several modes for determining the standard
deviation (sigma) of the noise:
- “fixed”: Sigma is a fixed value.
- “cooling”: Sigma anneals from an initial to a final value over a set number of steps.
- “dependent”: Sigma is predicted by a linear layer based on the input.
- “independent”: Sigma is a learnable parameter, independent of the input.</p>
<p>It can model the output as a Normal or LogNormal distribution.
If the base_predictor is an MLPNormalPredictor, it can model both the
mean and standard deviation of the underlying Normal distribution with noise.</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Return the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(x)</p></td>
<td><p>Performs a forward pass, returning the mean prediction from the base predictor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_dist</span></code>(x[, eps])</p></td>
<td><p>Performs a forward pass and returns a distribution object representing the noisy output.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sigma</span></code>(x)</p></td>
<td><p>Calculates and returns the current sigma based on the setting.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">output_to_dist</span></code>(output)</p></td>
<td><p>Converts the direct output of the Noisifier (which is the mean prediction) into a distribution, primarily for compatibility with interfaces expecting a distribution from the base predictor's output format.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module[, strict])</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(device)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_t</span></code>(new_t)</p></td>
<td><p>Updates the current step <cite>t</cite> for sigma cooling.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.problem"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.problem.Problem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Problem</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.data_dict (Python parameter)"><span class="n"><span class="pre">data_dict</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="p"><span class="pre">]</span></span></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.opt_model (Python parameter)"><span class="n"><span class="pre">opt_model</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><span class="pre">OptimizationModel</span></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.train_ratio (Python parameter)"><span class="n"><span class="pre">train_ratio</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mf">0.7</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.val_ratio (Python parameter)"><span class="n"><span class="pre">val_ratio</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mf">0.15</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.compute_optimal_decisions (Python parameter)"><span class="n"><span class="pre">compute_optimal_decisions</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.compute_optimal_objectives (Python parameter)"><span class="n"><span class="pre">compute_optimal_objectives</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.standardize_features (Python parameter)"><span class="n"><span class="pre">standardize_features</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.time_respecting_split (Python parameter)"><span class="n"><span class="pre">time_respecting_split</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.knn_robust_loss (Python parameter)"><span class="n"><span class="pre">knn_robust_loss</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mi">0</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.knn_robust_loss_weight (Python parameter)"><span class="n"><span class="pre">knn_robust_loss_weight</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mf">0.0</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.seed (Python parameter)"><span class="n"><span class="pre">seed</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.problem.Problem" title="src.problem.Problem.__init__.verbose (Python parameter)"><span class="n"><span class="pre">verbose</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.problem.Problem" title="Link to this definition">¶</a></dt>
<dd><p>Manages a decision-focused learning (DFL) problem encapsulating the dataset (<cite>DFLDataset</cite>) and an
optimization model (<cite>OptimizationModel</cite>). It is responsible for:</p>
<ul class="simple">
<li><p>Splitting the data into training, validation, and test sets.</p></li>
<li><p>Standardizing features if specified.</p></li>
<li><p>Computing optimal decisions and objectives for the dataset instances,
potentially using a k-NN robust approach if configured.</p></li>
<li><p>Providing an interface to access data batches for different modes (train/val/test).</p></li>
<li><p>Delegating solving, objective calculation, and evaluation tasks to the <cite>OptimizationModel</cite>.</p></li>
</ul>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><a class="headerlink" href="#src.problem.Problem.mode" title="Link to this definition">¶</a></dt>
<dd><p>The current operational mode of the problem instance
(e.g., ‘train’, ‘validation’, ‘test’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.train_indices">
<span class="sig-name descname"><span class="pre">train_indices</span></span><a class="headerlink" href="#src.problem.Problem.train_indices" title="Link to this definition">¶</a></dt>
<dd><p>Indices for the training dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.validation_indices">
<span class="sig-name descname"><span class="pre">validation_indices</span></span><a class="headerlink" href="#src.problem.Problem.validation_indices" title="Link to this definition">¶</a></dt>
<dd><p>Indices for the validation dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.test_indices">
<span class="sig-name descname"><span class="pre">test_indices</span></span><a class="headerlink" href="#src.problem.Problem.test_indices" title="Link to this definition">¶</a></dt>
<dd><p>Indices for the test dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.opt_model">
<span class="sig-name descname"><span class="pre">opt_model</span></span><a class="headerlink" href="#src.problem.Problem.opt_model" title="Link to this definition">¶</a></dt>
<dd><p>The optimization model associated with the problem.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OptimizationModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.num_vars">
<span class="sig-name descname"><span class="pre">num_vars</span></span><a class="headerlink" href="#src.problem.Problem.num_vars" title="Link to this definition">¶</a></dt>
<dd><p>Number of decision variables in the optimization model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.num_features">
<span class="sig-name descname"><span class="pre">num_features</span></span><a class="headerlink" href="#src.problem.Problem.num_features" title="Link to this definition">¶</a></dt>
<dd><p>Number of features in the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.params_to_predict_shapes">
<span class="sig-name descname"><span class="pre">params_to_predict_shapes</span></span><a class="headerlink" href="#src.problem.Problem.params_to_predict_shapes" title="Link to this definition">¶</a></dt>
<dd><p>Shapes of the parameters to be predicted
by a machine learning model, as defined in <cite>opt_model</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Tuple</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.num_predictions">
<span class="sig-name descname"><span class="pre">num_predictions</span></span><a class="headerlink" href="#src.problem.Problem.num_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Total number of scalar values to be predicted, derived
from <cite>params_to_predict_shapes</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.dataset">
<span class="sig-name descname"><span class="pre">dataset</span></span><a class="headerlink" href="#src.problem.Problem.dataset" title="Link to this definition">¶</a></dt>
<dd><p>The dataset object holding all problem instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.dataset.DFLDataset" title="src.dataset.DFLDataset (Python class) — DFLDataset class extends PyTorch's Dataset for decision-focused learning (DFL) scenarios."><em>DFLDataset</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.train_ratio">
<span class="sig-name descname"><span class="pre">train_ratio</span></span><a class="headerlink" href="#src.problem.Problem.train_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Proportion of the dataset to use for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.val_ratio">
<span class="sig-name descname"><span class="pre">val_ratio</span></span><a class="headerlink" href="#src.problem.Problem.val_ratio" title="Link to this definition">¶</a></dt>
<dd><p>Proportion of the dataset to use for validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.compute_optimal_decisions">
<span class="sig-name descname"><span class="pre">compute_optimal_decisions</span></span><a class="headerlink" href="#src.problem.Problem.compute_optimal_decisions" title="Link to this definition">¶</a></dt>
<dd><p>If True, computes and stores the
optimal decisions for each instance in the dataset. Defaults to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.time_respecting_split">
<span class="sig-name descname"><span class="pre">time_respecting_split</span></span><a class="headerlink" href="#src.problem.Problem.time_respecting_split" title="Link to this definition">¶</a></dt>
<dd><p>Whether to perform a time-respecting split (no shuffling before splitting).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.knn_robust_loss">
<span class="sig-name descname"><span class="pre">knn_robust_loss</span></span><a class="headerlink" href="#src.problem.Problem.knn_robust_loss" title="Link to this definition">¶</a></dt>
<dd><p>If greater than 0, enables k-NN robust loss
computation for the training set, using this value as the number of neighbours ‘k’.
This involves finding k-nearest neighbors to perturb parameters for robust
decision-making. Defaults to 0 (disabled).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.mode_to_indices">
<span class="sig-name descname"><span class="pre">mode_to_indices</span></span><a class="headerlink" href="#src.problem.Problem.mode_to_indices" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary mapping mode strings
(‘train’, ‘validation’, ‘test’) to their corresponding data indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Dict</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.total_num_samples">
<span class="sig-name descname"><span class="pre">total_num_samples</span></span><a class="headerlink" href="#src.problem.Problem.total_num_samples" title="Link to this definition">¶</a></dt>
<dd><p>Total number of samples in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.all_indices">
<span class="sig-name descname"><span class="pre">all_indices</span></span><a class="headerlink" href="#src.problem.Problem.all_indices" title="Link to this definition">¶</a></dt>
<dd><p>An array of all indices from 0 to num_samples-1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.train_size">
<span class="sig-name descname"><span class="pre">train_size</span></span><a class="headerlink" href="#src.problem.Problem.train_size" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples in the training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.validation_size">
<span class="sig-name descname"><span class="pre">validation_size</span></span><a class="headerlink" href="#src.problem.Problem.validation_size" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples in the validation set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.problem.Problem.test_size">
<span class="sig-name descname"><span class="pre">test_size</span></span><a class="headerlink" href="#src.problem.Problem.test_size" title="Link to this definition">¶</a></dt>
<dd><p>Number of samples in the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Attributes</p>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><strong>mode</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>test_indices</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>train_indices</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>validation_indices</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code>(data_batch, decisions_batch[, ...])</p></td>
<td><p>Evaluates various performance metrics for a batch, given true data, decisions, and optionally, predicted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_batch_indices</span></code>(batch_size)</p></td>
<td><p>Generates a list of index arrays (batches) for the currently set mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_objective</span></code>(data_batch, decisions_batch[, ...])</p></td>
<td><p>Calculates the objective value for a batch, given the true data, decisions, and optionally, predicted parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_data</span></code>(idx)</p></td>
<td><p>Retrieves data from the dataset for the specified indices.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_mode</span></code>(mode)</p></td>
<td><p>Sets the current operational mode of the Problem instance.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">solve</span></code>(data_batch)</p></td>
<td><p>Solves the optimization problem for a given batch of data.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split_dataset</span></code>([seed])</p></td>
<td><p>Splits the dataset indices into training, validation, and test sets.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.runner"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.runner.Runner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Runner</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.decision_maker (Python parameter)"><span class="n"><span class="pre">decision_maker</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker (Python class) — Abstract base class for a decision-making agent in a decision-focused learning pipeline."><span class="pre">DecisionMaker</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.num_epochs (Python parameter)"><span class="n"><span class="pre">num_epochs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mi">3</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.experiments_folder (Python parameter)"><span class="n"><span class="pre">experiments_folder</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;results/&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.main_metric (Python parameter)"><span class="n"><span class="pre">main_metric</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;abs_regret&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.val_metrics (Python parameter)"><span class="n"><span class="pre">val_metrics</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.test_metrics (Python parameter)"><span class="n"><span class="pre">test_metrics</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.store_min_and_max (Python parameter)"><span class="n"><span class="pre">store_min_and_max</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.use_wandb (Python parameter)"><span class="n"><span class="pre">use_wandb</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.experiment_name (Python parameter)"><span class="n"><span class="pre">experiment_name</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;-&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.project_name (Python parameter)"><span class="n"><span class="pre">project_name</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;-&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.early_stop (Python parameter)"><span class="n"><span class="pre">early_stop</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.min_delta_early_stop (Python parameter)"><span class="n"><span class="pre">min_delta_early_stop</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.patience_early_stop (Python parameter)"><span class="n"><span class="pre">patience_early_stop</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.save_best (Python parameter)"><span class="n"><span class="pre">save_best</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.seed (Python parameter)"><span class="n"><span class="pre">seed</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.full_reproducibility_GPUs (Python parameter)"><span class="n"><span class="pre">full_reproducibility_GPUs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.config (Python parameter)"><span class="n"><span class="pre">config</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.runner.Runner" title="src.runner.Runner.__init__.verbose (Python parameter)"><span class="n"><span class="pre">verbose</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.runner.Runner" title="Link to this definition">¶</a></dt>
<dd><p>The Runner class allows for running experiments. It uses the given DecisionMaker to run the experiments with and
initializes a Logger to log results. It handles the training and evaluation process, including logging,
early stopping, and saving the best models found so far.</p>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.decision_maker">
<span class="sig-name descname"><span class="pre">decision_maker</span></span><a class="headerlink" href="#src.runner.Runner.decision_maker" title="Link to this definition">¶</a></dt>
<dd><p>The decision maker instance to be trained and evaluated.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker (Python class) — Abstract base class for a decision-making agent in a decision-focused learning pipeline."><em>DecisionMaker</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.num_epochs">
<span class="sig-name descname"><span class="pre">num_epochs</span></span><a class="headerlink" href="#src.runner.Runner.num_epochs" title="Link to this definition">¶</a></dt>
<dd><p>The total number of epochs for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#src.runner.Runner.config" title="Link to this definition">¶</a></dt>
<dd><p>A dictionary containing experiment configurations to be logged.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Any</em>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.experiments_folder">
<span class="sig-name descname"><span class="pre">experiments_folder</span></span><a class="headerlink" href="#src.runner.Runner.experiments_folder" title="Link to this definition">¶</a></dt>
<dd><p>The root directory where experiment results will be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.use_wandb">
<span class="sig-name descname"><span class="pre">use_wandb</span></span><a class="headerlink" href="#src.runner.Runner.use_wandb" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating if Weights &amp; Biases logging is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.experiment_name">
<span class="sig-name descname"><span class="pre">experiment_name</span></span><a class="headerlink" href="#src.runner.Runner.experiment_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the current experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.project_name">
<span class="sig-name descname"><span class="pre">project_name</span></span><a class="headerlink" href="#src.runner.Runner.project_name" title="Link to this definition">¶</a></dt>
<dd><p>Name of the project for logging purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.early_stop">
<span class="sig-name descname"><span class="pre">early_stop</span></span><a class="headerlink" href="#src.runner.Runner.early_stop" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating if early stopping is enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.min_delta_early_stop">
<span class="sig-name descname"><span class="pre">min_delta_early_stop</span></span><a class="headerlink" href="#src.runner.Runner.min_delta_early_stop" title="Link to this definition">¶</a></dt>
<dd><p>Minimum change in the main metric to be considered an improvement
for early stopping.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.patience_early_stop">
<span class="sig-name descname"><span class="pre">patience_early_stop</span></span><a class="headerlink" href="#src.runner.Runner.patience_early_stop" title="Link to this definition">¶</a></dt>
<dd><p>Number of epochs to wait for an improvement before stopping early.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.save_best">
<span class="sig-name descname"><span class="pre">save_best</span></span><a class="headerlink" href="#src.runner.Runner.save_best" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating if the best performing model should be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.main_metric">
<span class="sig-name descname"><span class="pre">main_metric</span></span><a class="headerlink" href="#src.runner.Runner.main_metric" title="Link to this definition">¶</a></dt>
<dd><p>The primary metric used for model selection and early stopping.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.store_min_and_max">
<span class="sig-name descname"><span class="pre">store_min_and_max</span></span><a class="headerlink" href="#src.runner.Runner.store_min_and_max" title="Link to this definition">¶</a></dt>
<dd><p>Whether to store min and max values of metrics in the logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.verbose">
<span class="sig-name descname"><span class="pre">verbose</span></span><a class="headerlink" href="#src.runner.Runner.verbose" title="Link to this definition">¶</a></dt>
<dd><p>If True, print status messages to the console.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.main_metric_sense">
<span class="sig-name descname"><span class="pre">main_metric_sense</span></span><a class="headerlink" href="#src.runner.Runner.main_metric_sense" title="Link to this definition">¶</a></dt>
<dd><p>Direction of optimisation for the main metric, either ‘MIN’ or ‘MAX’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.no_improvement_count">
<span class="sig-name descname"><span class="pre">no_improvement_count</span></span><a class="headerlink" href="#src.runner.Runner.no_improvement_count" title="Link to this definition">¶</a></dt>
<dd><p>Counter for epochs without significant improvement, used for early stopping.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.best_val_metric">
<span class="sig-name descname"><span class="pre">best_val_metric</span></span><a class="headerlink" href="#src.runner.Runner.best_val_metric" title="Link to this definition">¶</a></dt>
<dd><p>Stores the best validation metric value achieved so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.runner.Runner.logger">
<span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#src.runner.Runner.logger" title="Link to this definition">¶</a></dt>
<dd><p>The logger instance used for recording experiment results.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.logger.Logger" title="src.logger.Logger (Python class) — A comprehensive logging class for machine learning experiments, integrating with Weights &amp; Biases and managing local log files. It aggregates per-batch results into epoch-level metrics. See src.utils for method load_log for loading logs."><em>Logger</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code>([optuna_trial])</p></td>
<td><p>Runs the experiment.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.decision_makers.base"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.decision_makers.base.DecisionMaker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DecisionMaker</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.problem (Python parameter)"><span class="n"><span class="pre">problem</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference internal" href="#src.problem.Problem" title="src.problem.Problem (Python class) — Manages a decision-focused learning (DFL) problem encapsulating the dataset (DFLDataset) and an optimization model (OptimizationModel). It is responsible for:"><span class="pre">Problem</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.learning_rate (Python parameter)"><span class="n"><span class="pre">learning_rate</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mf">1e-4</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.device_str (Python parameter)"><span class="n"><span class="pre">device_str</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;cpu&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.predictor_str (Python parameter)"><span class="n"><span class="pre">predictor_str</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;MLP&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.decision_model_str (Python parameter)"><span class="n"><span class="pre">decision_model_str</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;base&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.loss_function_str (Python parameter)"><span class="n"><span class="pre">loss_function_str</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;objective&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.to_decision_pars (Python parameter)"><span class="n"><span class="pre">to_decision_pars</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;none&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.use_dist_at_mode (Python parameter)"><span class="n"><span class="pre">use_dist_at_mode</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="s1">&#39;none&#39;</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.use_noisifier (Python parameter)"><span class="n"><span class="pre">use_noisifier</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.standardize_predictions (Python parameter)"><span class="n"><span class="pre">standardize_predictions</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">True</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.init_OLS (Python parameter)"><span class="n"><span class="pre">init_OLS</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">False</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.seed (Python parameter)"><span class="n"><span class="pre">seed</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.predictor_kwargs (Python parameter)"><span class="n"><span class="pre">predictor_kwargs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.noisifier_kwargs (Python parameter)"><span class="n"><span class="pre">noisifier_kwargs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.decision_makers.base.DecisionMaker" title="src.decision_makers.base.DecisionMaker.__init__.decision_model_kwargs (Python parameter)"><span class="n"><span class="pre">decision_model_kwargs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="kc">None</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker" title="Link to this definition">¶</a></dt>
<dd><p>Abstract base class for a decision-making agent in a decision-focused learning pipeline.</p>
<p>This class orchestrates the interaction between a predictive model (<cite>predictor</cite>),
an optional <cite>noisifier</cite> to add stochasticity to predictions, and a <cite>decision_model</cite>
(an optimization model) to make decisions based on (potentially noisy) predictions.
It handles the initialization of these components, the process of predicting
parameters and making decisions, and provides hooks for training and evaluation.</p>
<p>The class is organized into several categories of methods:
- Abstract methods for subclass implementation: Need to be implemented for a subclass to work.
- Core logic methods: Methods that include the core logic of what a decision maker entails
- Helper methods: Local methods that support other methods
- Conversion methods: Methods that convert, i.e., transform or reshape certain objects.
- Initialization methods: Methods that do initialization</p>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.problem">
<span class="sig-name descname"><span class="pre">problem</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.problem" title="Link to this definition">¶</a></dt>
<dd><p>The problem instance containing data and the true optimization model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.problem.Problem" title="src.problem.Problem (Python class) — Manages a decision-focused learning (DFL) problem encapsulating the dataset (DFLDataset) and an optimization model (OptimizationModel). It is responsible for:"><em>Problem</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.learning_rate" title="Link to this definition">¶</a></dt>
<dd><p>Learning rate for the trainable components.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.device" title="Link to this definition">¶</a></dt>
<dd><p>The device (CPU or GPU) on which computations are performed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.predictor_str">
<span class="sig-name descname"><span class="pre">predictor_str</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.predictor_str" title="Link to this definition">¶</a></dt>
<dd><p>String identifier for the type of predictor used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.decision_model_str">
<span class="sig-name descname"><span class="pre">decision_model_str</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.decision_model_str" title="Link to this definition">¶</a></dt>
<dd><p>String identifier for the type of decision model used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.loss_function_str">
<span class="sig-name descname"><span class="pre">loss_function_str</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.loss_function_str" title="Link to this definition">¶</a></dt>
<dd><p>String identifier for the loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.to_decision_pars">
<span class="sig-name descname"><span class="pre">to_decision_pars</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.to_decision_pars" title="Link to this definition">¶</a></dt>
<dd><p>Strategy for converting distributional predictions to
deterministic parameters for the decision model (e.g., ‘sample’, ‘quantiles’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.use_dist_at_mode">
<span class="sig-name descname"><span class="pre">use_dist_at_mode</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.use_dist_at_mode" title="Link to this definition">¶</a></dt>
<dd><p>Specifies if/when to use full distributional output from
predictor/noisifier (e.g., ‘test’ mode).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.use_noisifier">
<span class="sig-name descname"><span class="pre">use_noisifier</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.use_noisifier" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether a noisifier is used on top of the base predictor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.standardize_predictions">
<span class="sig-name descname"><span class="pre">standardize_predictions</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.standardize_predictions" title="Link to this definition">¶</a></dt>
<dd><p>Flag indicating whether to standardize predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.predictor_kwargs">
<span class="sig-name descname"><span class="pre">predictor_kwargs</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.predictor_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Keyword arguments for predictor initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.noisifier_kwargs">
<span class="sig-name descname"><span class="pre">noisifier_kwargs</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.noisifier_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Keyword arguments for noisifier initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.decision_model_kwargs">
<span class="sig-name descname"><span class="pre">decision_model_kwargs</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.decision_model_kwargs" title="Link to this definition">¶</a></dt>
<dd><p>Keyword arguments for decision model initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>, <em>Any</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.decision_model">
<span class="sig-name descname"><span class="pre">decision_model</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.decision_model" title="Link to this definition">¶</a></dt>
<dd><p>The instantiated optimization model used for making decisions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OptimizationModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.predictor">
<span class="sig-name descname"><span class="pre">predictor</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.predictor" title="Link to this definition">¶</a></dt>
<dd><p>The instantiated predictive model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor (Python class) — Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module."><em>Predictor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.best_predictor">
<span class="sig-name descname"><span class="pre">best_predictor</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.best_predictor" title="Link to this definition">¶</a></dt>
<dd><p>A copy of the predictor with the best validation performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor (Python class) — Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module."><em>Predictor</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.noisifier">
<span class="sig-name descname"><span class="pre">noisifier</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.noisifier" title="Link to this definition">¶</a></dt>
<dd><p>The instantiated noisifier, if <cite>use_noisifier</cite> is True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference internal" href="#src.noisifier.Noisifier" title="src.noisifier.Noisifier (Python class) — A class that adds noise to the output of a base predictor."><em>Noisifier</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.trainable_predictive_model">
<span class="sig-name descname"><span class="pre">trainable_predictive_model</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.trainable_predictive_model" title="Link to this definition">¶</a></dt>
<dd><p>The PyTorch module that is trained (either
the predictor or the noisifier if used).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker.num_scenarios">
<span class="sig-name descname"><span class="pre">num_scenarios</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker.num_scenarios" title="Link to this definition">¶</a></dt>
<dd><p>Number of scenarios used if <cite>to_decision_pars</cite> involves sampling
or quantiles, derived from <cite>decision_model_kwargs</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Optional</em>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker._solver_calls">
<span class="sig-name descname"><span class="pre">_solver_calls</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker._solver_calls" title="Link to this definition">¶</a></dt>
<dd><p>Counter for the number of times the decision model’s solver is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.decision_makers.base.DecisionMaker._epoch_counts">
<span class="sig-name descname"><span class="pre">_epoch_counts</span></span><a class="headerlink" href="#src.decision_makers.base.DecisionMaker._epoch_counts" title="Link to this definition">¶</a></dt>
<dd><p>Counter for the number of epochs run (though not explicitly updated in this snippet).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Attributes</p>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><strong>best_predictor</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">decide</span></code>(predictions_batch)</p></td>
<td><p>Makes decisions using the <cite>self.decision_model</cite> based on the provided predictions.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict_to_decisions</span></code>(decisions_batch[, use_optimal])</p></td>
<td><p>Reverts a dictionary of named parameter predictions back into a single flat tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict_to_predictions</span></code>(predictions_batch)</p></td>
<td><p>Reverts a dictionary of named parameter predictions back into a single flat tensor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict_to_tensor</span></code>(predictions_dict[, output_device])</p></td>
<td><p>Converts a dictionary of tensors to a single tensor by concatenating them.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code>(data_batch[, output_device])</p></td>
<td><p>Generates predictions for a given data batch.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_and_decide</span></code>(data_batch)</p></td>
<td><p>Performs a prediction step followed by a decision-making step.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">predictions_to_dict</span></code>(predictions[, output_device])</p></td>
<td><p>Converts a flat tensor of predictions into a dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_epoch</span></code>(mode, epoch_num[, metrics])</p></td>
<td><p>Runs one full epoch of operations (training, validation, or testing).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_best_predictor</span></code>()</p></td>
<td><p>Saves a deep copy of the current <cite>self.predictor</cite> to <cite>self.best_predictor</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update</span></code>(data_batch)</p></td>
<td><p>Performs a single training update step for the learnable components.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-src.predictors.base"></span><dl class="py class objdesc">
<dt class="sig sig-object highlight sig-wrap py" id="src.predictors.base.Predictor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Predictor</span></span><span class="sig-paren">(</span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor.__init__.num_inputs (Python parameter)"><span class="n"><span class="pre">num_inputs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor.__init__.num_outputs (Python parameter)"><span class="n"><span class="pre">num_outputs</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span></em>, </span><span class="sig-param-decl"><em class="sig-param"><a class="n reference internal" href="#src.predictors.base.Predictor" title="src.predictors.base.Predictor.__init__.num_scenarios (Python parameter)"><span class="n"><span class="pre">num_scenarios</span></span></a><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="desctype"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><code class="code python default_value docutils literal highlight highlight-python"><span class="mi">1</span></code></em></span><span class="sig-paren">)</span><a class="headerlink" href="#src.predictors.base.Predictor" title="Link to this definition">¶</a></dt>
<dd><p>Base class for all predictors. Predictors are restricted to be instances of torch.nn.Module.</p>
<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.predictors.base.Predictor.num_inputs">
<span class="sig-name descname"><span class="pre">num_inputs</span></span><a class="headerlink" href="#src.predictors.base.Predictor.num_inputs" title="Link to this definition">¶</a></dt>
<dd><p>The number of inputs for the predictor.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.predictors.base.Predictor.num_outputs">
<span class="sig-name descname"><span class="pre">num_outputs</span></span><a class="headerlink" href="#src.predictors.base.Predictor.num_outputs" title="Link to this definition">¶</a></dt>
<dd><p>The total number of outputs the predictor produces.
If num_scenarios &gt; 1, this is the total output (output_per_scenario * num_scenarios).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute objdesc">
<dt class="sig sig-object highlight py" id="src.predictors.base.Predictor.num_scenarios">
<span class="sig-name descname"><span class="pre">num_scenarios</span></span><a class="headerlink" href="#src.predictors.base.Predictor.num_scenarios" title="Link to this definition">¶</a></dt>
<dd><p>The number of scenarios the predictor is designed to handle.
If 1, the predictor outputs a single prediction.
If &gt; 1, the predictor outputs multiple predictions (one per scenario).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Add a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Apply <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Return an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compile</span></code>(*args, **kwargs)</p></td>
<td><p>Compile this Module's forward using <code class="xref py py-func docutils literal notranslate"><span class="pre">torch.compile()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Move all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Set the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Return the extra representation of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">float</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(x)</p></td>
<td><p>Abstract method for the forward pass of the predictor.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward_mean</span></code>(x)</p></td>
<td><p>Computes the mean of the predictor's output across scenarios.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_buffer</span></code>(target)</p></td>
<td><p>Return the buffer given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_extra_state</span></code>()</p></td>
<td><p>Return any extra state to include in the module's state_dict.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_parameter</span></code>(target)</p></td>
<td><p>Return the parameter given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_submodule</span></code>(target)</p></td>
<td><p>Return the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ipu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the IPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict, assign])</p></td>
<td><p>Copy parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Return an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mtia</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the MTIA.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Return an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix, remove_duplicate])</p></td>
<td><p>Return an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse, ...])</p></td>
<td><p>Return an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Return an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Add a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook, *[, prepend, ...])</p></td>
<td><p>Register a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook, *[, ...])</p></td>
<td><p>Register a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_full_backward_pre_hook</span></code>(hook[, prepend])</p></td>
<td><p>Register a backward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook to be run after module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_load_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook to be run before module's <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_state_dict()</span></code> is called.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_module</span></code>(name, module)</p></td>
<td><p>Alias for <code class="xref py py-func docutils literal notranslate"><span class="pre">add_module()</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Add a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_post_hook</span></code>(hook)</p></td>
<td><p>Register a post-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_state_dict_pre_hook</span></code>(hook)</p></td>
<td><p>Register a pre-hook for the <code class="xref py py-meth docutils literal notranslate"><span class="pre">state_dict()</span></code> method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_extra_state</span></code>(state)</p></td>
<td><p>Set extra state contained in the loaded <cite>state_dict</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_submodule</span></code>(target, module[, strict])</p></td>
<td><p>Set the submodule given by <code class="docutils literal notranslate"><span class="pre">target</span></code> if it exists, otherwise throw an error.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">share_memory</span></code>()</p></td>
<td><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.Tensor.share_memory_()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>(*args[, destination, prefix, ...])</p></td>
<td><p>Return a dictionary containing references to the whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Move and/or cast the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_empty</span></code>(*, device[, recurse])</p></td>
<td><p>Move the parameters and buffers to the specified device without copying storage.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Set the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">xpu</span></code>([device])</p></td>
<td><p>Move all model parameters and buffers to the XPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>([set_to_none])</p></td>
<td><p>Reset gradients of all model parameters.</p></td>
</tr>
</tbody>
</table>
<table class="docutils data align-default">
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>







  
  






                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025 - 2025, Noah Schutte, Kim van den Houten, Grigorii Veviurko.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.top"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
  </body>
</html>