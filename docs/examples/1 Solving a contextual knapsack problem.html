


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../index.html">
      
      
        <link rel="next" href="2%20Running%20experiments%20using%20registries.html">
      
      
      <link rel="icon" href="">
    
    
      
        <title>1 Solving a contextual knapsack problem - PyDFLT  documentation</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../_static/sphinx_immaterial_theme.acf80fe7f4d9ef9e2.min.css?v=9e56d0d2" />
        <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
        <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=8071119b" />
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1.0-Introduction-to-Decision-Focused-Learning-(DFL)" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="PyDFLT  documentation" class="md-header__button md-logo" aria-label="PyDFLT  documentation" data-md-component="logo">
      <img src="../_static/logo_small.png" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyDFLT  documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1 Solving a contextual knapsack problem
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PyDFLT/PyDFLT/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PyDFLT
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="PyDFLT  documentation" class="md-nav__button md-logo" aria-label="PyDFLT  documentation" data-md-component="logo">
      <img src="../_static/logo_small.png" alt="logo">
    </a>
    PyDFLT  documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PyDFLT/PyDFLT/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    PyDFLT
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    <span>Examples</span>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            <span>Examples</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/examples/1 solving a contextual knapsack problem.ipynb (reference label)"><span>1 Solving a contextual knapsack problem</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/1 solving a contextual knapsack problem.ipynb (reference label)"><span>1 Solving a contextual knapsack problem</span></span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1.0-Introduction-to-Decision-Focused-Learning-(DFL)" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.0-introduction-to-decision-focused-learning-(dfl) (reference label)"><span>1.<wbr>0 Introduction to Decision-<wbr>Focused Learning <wbr>(DFL)</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.1-The-OptimizationModel" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.1-the-optimizationmodel (reference label)"><span>1.<wbr>1 The Optimization<wbr>Model</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.2-The-Dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.2-the-dataset (reference label)"><span>1.<wbr>2 The Dataset</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.3-The-Problem" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.3-the-problem (reference label)"><span>1.<wbr>3 The Problem</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.4-The-DecisionMaker" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.4-the-decisionmaker (reference label)"><span>1.<wbr>4 The Decision<wbr>Maker</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.5-The-Runner" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.5-the-runner (reference label)"><span>1.<wbr>5 The Runner</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.5 The Runner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="2%20Running%20experiments%20using%20registries.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/2 running experiments using registries.ipynb (reference label)"><span>2 Running experiments using registries</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="3%20Analyzing%20training%20using%20Weights%20and%20Biases.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/3 analyzing training using weights and biases.ipynb (reference label)"><span>3 Analyzing training using Weights and Biases</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="4%20Hyperparameter%20tuning%20using%20Optuna.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/4 hyperparameter tuning using optuna.ipynb (reference label)"><span>4 Hyperparamater tuning using Optuna</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="5%20DFL%20methods%20for%20non-specific%20optimization%20models.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/examples/5 dfl methods for non-specific optimization models.ipynb (reference label)"><span>5 DFL methods for non-<wbr>specific optimization models</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
      
      
  
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    <span>API reference</span>
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <span>API reference</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/src.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/api/src.rst (reference label)"><span>Py<wbr>DFLT</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1.0-Introduction-to-Decision-Focused-Learning-(DFL)" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.0-introduction-to-decision-focused-learning-(dfl) (reference label)"><span>1.<wbr>0 Introduction to Decision-<wbr>Focused Learning <wbr>(DFL)</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.1-The-OptimizationModel" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.1-the-optimizationmodel (reference label)"><span>1.<wbr>1 The Optimization<wbr>Model</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.2-The-Dataset" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.2-the-dataset (reference label)"><span>1.<wbr>2 The Dataset</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.3-The-Problem" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.3-the-problem (reference label)"><span>1.<wbr>3 The Problem</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.4-The-DecisionMaker" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.4-the-decisionmaker (reference label)"><span>1.<wbr>4 The Decision<wbr>Maker</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1.5-The-Runner" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#1.5-the-runner (reference label)"><span>1.<wbr>5 The Runner</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1.5 The Runner">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/examples/1 solving a contextual knapsack problem.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="1-Solving-a-contextual-knapsack-problem">1 Solving a contextual knapsack problem<a class="headerlink" href="#1-Solving-a-contextual-knapsack-problem" title="Link to this heading">¶</a></h1>
<p>In this notebook we shortly introduce Decision-Focused Learning, and how it can be applied to a contextual knapsack problem. With this, we present the basic structure of PyDFLT.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="n">path_to_project</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="s2">&quot;PyDFLT&quot;</span><span class="p">))))</span>
</code></pre></div>
</div>
</div>
<h2 id="1.0-Introduction-to-Decision-Focused-Learning-(DFL)">1.0 Introduction to Decision-Focused Learning (DFL)<a class="headerlink" href="#1.0-Introduction-to-Decision-Focused-Learning-(DFL)" title="Link to this heading">¶</a></h2>
<p>DFL aims at learning a predictive model that maximizes the decision quality of a downstream decision-making task or optimization model. This problem as a whole is named a predict &amp; optimize or contextual optimization problem. In this setting, the optimization model has some uncertain parameters that correlate with some context or features. If seen as a pure predictive problem, one could aim to maximize predictive accuracy. However, since we know we will use the predictions to make decisions, we
aim at maximizing decision quality. To do this, PyDFLT is based on a general structure including the following components:</p>
<ol class="arabic simple">
<li><p>An <code class="docutils literal notranslate"><span class="pre">OptimizationModel</span></code> which specifies the optimization model/decision-making task we try to tackle, including some uncertain parameters</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> which includes the training data, i.e., the context/feature values that correlate with the uncertain parameters</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">Problem</span></code> we are trying to solve, defined by the <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> and <code class="docutils literal notranslate"><span class="pre">OptimizationModel</span></code></p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">DecisionMaker</span></code>, which includes the DFL approach that is used to learn the mapping from features to decisions. It includes a <code class="docutils literal notranslate"><span class="pre">Predictor</span></code> to map from features to uncertain parameters, and a decision model to map from uncertain parameters to decisions.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">Runner</span></code> which runs the training loop to train the <code class="docutils literal notranslate"><span class="pre">DecisionMaker</span></code> in making high-quality decisions.</p></li>
</ol>
<p>We will show the usage of these components in this notebook, applied to a continuous knapsack problem.</p>
<h2 id="1.1-The-OptimizationModel">1.1 The <code class="docutils literal notranslate"><span class="pre">OptimizationModel</span></code><a class="headerlink" href="#1.1-The-OptimizationModel" title="Link to this heading">¶</a></h2>
<p>The optimization model is the formulation of the model that the decision maker wants to solve in practice. Given some realization of the uncertain parameters, solving the model will lead to a decision. Currently we support models defined as a differentiable model using CVXPY or models defined using gurobipy (including two-stage stochastic models). In <code class="docutils literal notranslate"><span class="pre">src/concrete_models</span></code> there are pre-implemented models defined. For each type of model some methods are required that define the model (for
example <code class="docutils literal notranslate"><span class="pre">get_objective</span></code> and <code class="docutils literal notranslate"><span class="pre">_create_model</span></code>). As an example we will take a continuous knapsack model.</p>
<p>A continuous knapsack model consists of a set of items with a value and a weight. The goal is to pick items such that you maximize the total value while adhering to the capacity constraint: the weights cannot exceed the capacity. In the continuous variant, you are allowed to pick partial items. This model is differentiable, which means we use <em>CVXPYLayers</em> [1] under the hood.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.concrete_models</span><span class="w"> </span><span class="kn">import</span> <span class="n">CVXPYDiffKnapsackModel</span>

<span class="n">num_items</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">optimization_model</span> <span class="o">=</span> <span class="n">CVXPYDiffKnapsackModel</span><span class="p">(</span><span class="n">num_decisions</span><span class="o">=</span><span class="n">num_items</span><span class="p">,</span> <span class="n">capacity</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">weights_lb</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">weights_ub</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Auto-Sklearn cannot be imported.
</pre></div></div>
</div>
<h2 id="1.2-The-Dataset">1.2 The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code><a class="headerlink" href="#1.2-The-Dataset" title="Link to this heading">¶</a></h2>
<p>For a DFL problem there is data required with feature and uncertain parameter pairs. The <code class="docutils literal notranslate"><span class="pre">Dataset</span></code> itself is created by the problem class, so the only requirement for the data is that it is in a <code class="docutils literal notranslate"><span class="pre">dict</span></code> that has a <code class="docutils literal notranslate"><span class="pre">'features'</span></code> key and a key for each uncertain parameters as defined in the <code class="docutils literal notranslate"><span class="pre">OptimizationModel</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.generate_data_functions.generate_data_knapsack</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_data_knapsack</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uncertain parameter names: </span><span class="si">{</span><span class="n">optimization_model</span><span class="o">.</span><span class="n">param_to_predict_names</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">gen_data_knapsack</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">num_data</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">num_items</span><span class="o">=</span><span class="n">num_items</span><span class="p">,</span> <span class="n">num_features</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data dictionary keys: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Uncertain parameter names: [&#39;item_value&#39;].
Data dictionary keys: dict_keys([&#39;item_value&#39;, &#39;features&#39;]).
</pre></div></div>
</div>
<h2 id="1.3-The-Problem">1.3 The <code class="docutils literal notranslate"><span class="pre">Problem</span></code><a class="headerlink" href="#1.3-The-Problem" title="Link to this heading">¶</a></h2>
<p>A DFL problem is defined by an optimization model and data, so we can now define the problem. It also includes the train/validation/test ratios. Optimal decisions and objectives for the in data observed parameter realization are most efficiently computed upfront, which is one of the <code class="docutils literal notranslate"><span class="pre">Problem</span></code>’s settings. There are some other settings including not randomizing the split but keeping the data in (timely) order <code class="docutils literal notranslate"><span class="pre">time_respecting_split</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.problem</span><span class="w"> </span><span class="kn">import</span> <span class="n">Problem</span>

<span class="n">problem</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span>
    <span class="n">data_dict</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
    <span class="n">opt_model</span><span class="o">=</span><span class="n">optimization_model</span><span class="p">,</span>
    <span class="n">train_ratio</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
    <span class="n">val_ratio</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">compute_optimal_decisions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">compute_optimal_objectives</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">time_respecting_split</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Computing optimal decisions for the entire dataset...
Optimal decisions computed and added to dataset.
Computing optimal objectives for the entire dataset...
Optimal objectives computed and added to dataset.
Shuffling indices before splitting...
Dataset split completed: Train=1400, Validation=300, Test=300
</pre></div></div>
</div>
<h2 id="1.4-The-DecisionMaker">1.4 The <code class="docutils literal notranslate"><span class="pre">DecisionMaker</span></code><a class="headerlink" href="#1.4-The-DecisionMaker" title="Link to this heading">¶</a></h2>
<p>This is the object that maps from features to decisions, which is generally done using a <code class="docutils literal notranslate"><span class="pre">Predictor</span></code> that maps from features to uncertain parameters and a <code class="docutils literal notranslate"><span class="pre">decision_model</span></code> based on the defined <code class="docutils literal notranslate"><span class="pre">OptimizationModel</span></code> that maps from uncertain parameters to decisions. The <code class="docutils literal notranslate"><span class="pre">DecisionMaker</span></code> includes the method that is used to train itself and therefore always includes a <code class="docutils literal notranslate"><span class="pre">run_epoch</span></code> and an <code class="docutils literal notranslate"><span class="pre">update</span></code> method. The <code class="docutils literal notranslate"><span class="pre">DifferentiableDecisionMaker</span></code> uses differentiation. Training its <code class="docutils literal notranslate"><span class="pre">Predictor</span></code> to
minimize mean squared error (Prediction-Focused Learning) for example can be done using this decision maker, but also using any differentiable surrogate losses implemented in <em>PyEPO</em> [2], or differentiating through the optimization model using <em>CVXPYLayers</em> [1] is possible. The other decision makers do not use direct differentiation, but for example use stochastic gradient estimation to differentiate. Our example problem is differentiable, so we use <code class="docutils literal notranslate"><span class="pre">'regret'</span></code> as loss function. As a predictor
we use a linear predictor (Multi Layer Perceptron without hidden layers).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.decision_makers</span><span class="w"> </span><span class="kn">import</span> <span class="n">DifferentiableDecisionMaker</span>

<span class="n">decision_maker</span> <span class="o">=</span> <span class="n">DifferentiableDecisionMaker</span><span class="p">(</span>
    <span class="n">problem</span><span class="o">=</span><span class="n">problem</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">loss_function_str</span><span class="o">=</span><span class="s2">&quot;objective&quot;</span><span class="p">,</span> <span class="n">predictor_str</span><span class="o">=</span><span class="s2">&quot;MLP&quot;</span><span class="p">,</span> <span class="n">predictor_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;num_hidden_layers&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">5</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Problem mode set to: train
Problem mode set to: train
</pre></div></div>
</div>
<h2 id="1.5-The-Runner">1.5 The <code class="docutils literal notranslate"><span class="pre">Runner</span></code><a class="headerlink" href="#1.5-The-Runner" title="Link to this heading">¶</a></h2>
<p>This object is used to train the <code class="docutils literal notranslate"><span class="pre">DecisionMaker</span></code>. It includes the number of epochs to run and also defines what are important metrics. When <code class="docutils literal notranslate"><span class="pre">save_best=True</span></code>, it stores the best performing model on the validation set, otherwise it just takes the model obtained after the last epoch.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.runner</span><span class="w"> </span><span class="kn">import</span> <span class="n">Runner</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">Runner</span><span class="p">(</span><span class="n">decision_maker</span><span class="o">=</span><span class="n">decision_maker</span><span class="p">,</span> <span class="n">num_epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">main_metric</span><span class="o">=</span><span class="s2">&quot;objective&quot;</span><span class="p">,</span> <span class="n">use_wandb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_best</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">runner</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Epoch 0/50: Starting initial validation...
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2245
validation/mse_mean: 58.9803
validation/select_item_mean: 0.3878
validation/rel_regret_mean: 0.3488
validation/objective_mean: 19.8806
validation/item_value_mean: 4.8527
validation/abs_regret_mean: 10.6120
Initial best validation metric (objective): 19.880634307861328
Starting training...
Epoch: 1/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2245
validation/mse_mean: 58.9803
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3878
validation/rel_regret_mean: 0.3488
validation/objective_mean: 19.8806
validation/item_value_mean: 4.8527
train/rel_regret_mean: 0.3579
validation/abs_regret_mean: 10.6120
train/solver_calls_mean: 1035.6364
train/objective_mean: 18.2098
train/abs_regret_mean: 10.6294
train/loss_mean: -18.2098
train/sym_rel_regret_mean: 0.2314
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2251
validation/mse_mean: 58.9374
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3497
validation/objective_mean: 19.8498
validation/item_value_mean: 4.8483
train/rel_regret_mean: 0.3579
validation/abs_regret_mean: 10.6428
train/solver_calls_mean: 1035.6364
train/objective_mean: 18.2098
train/abs_regret_mean: 10.6294
train/loss_mean: -18.2098
train/sym_rel_regret_mean: 0.2314
Validation evaluation (objective): 19.819040298461914
New best validation evaluation (objective): 19.819040298461914 (was 19.880634307861328)
Epoch: 2/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2251
validation/mse_mean: 58.9374
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3497
validation/objective_mean: 19.8498
validation/item_value_mean: 4.8483
train/rel_regret_mean: 0.3579
validation/abs_regret_mean: 10.6428
train/solver_calls_mean: 1885.6364
train/objective_mean: 18.1968
train/abs_regret_mean: 10.6354
train/loss_mean: -18.1968
train/sym_rel_regret_mean: 0.2313
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2255
validation/mse_mean: 58.9355
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3503
validation/objective_mean: 19.8331
validation/item_value_mean: 4.8439
train/rel_regret_mean: 0.3579
validation/abs_regret_mean: 10.6595
train/solver_calls_mean: 1885.6364
train/objective_mean: 18.1968
train/abs_regret_mean: 10.6354
train/loss_mean: -18.1968
train/sym_rel_regret_mean: 0.2313
Validation evaluation (objective): 19.799713134765625
New best validation evaluation (objective): 19.799713134765625 (was 19.819040298461914)
Epoch: 3/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2255
validation/mse_mean: 58.9355
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3503
validation/objective_mean: 19.8331
validation/item_value_mean: 4.8439
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.6595
train/solver_calls_mean: 2735.6364
train/objective_mean: 18.1968
train/abs_regret_mean: 10.6264
train/loss_mean: -18.1968
train/sym_rel_regret_mean: 0.2314
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2257
validation/mse_mean: 58.9333
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3506
validation/objective_mean: 19.8125
validation/item_value_mean: 4.8416
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.6801
train/solver_calls_mean: 2735.6364
train/objective_mean: 18.1968
train/abs_regret_mean: 10.6264
train/loss_mean: -18.1968
train/sym_rel_regret_mean: 0.2314
Validation evaluation (objective): 19.750717163085938
New best validation evaluation (objective): 19.750717163085938 (was 19.799713134765625)
Epoch: 4/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2257
validation/mse_mean: 58.9333
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3506
validation/objective_mean: 19.8125
validation/item_value_mean: 4.8416
train/rel_regret_mean: 0.3578
validation/abs_regret_mean: 10.6801
train/solver_calls_mean: 3585.6364
train/objective_mean: 18.2031
train/abs_regret_mean: 10.6106
train/loss_mean: -18.2031
train/sym_rel_regret_mean: 0.2313
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2258
validation/mse_mean: 58.9447
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3507
validation/objective_mean: 19.8100
validation/item_value_mean: 4.8402
train/rel_regret_mean: 0.3578
validation/abs_regret_mean: 10.6826
train/solver_calls_mean: 3585.6364
train/objective_mean: 18.2031
train/abs_regret_mean: 10.6106
train/loss_mean: -18.2031
train/sym_rel_regret_mean: 0.2313
Validation evaluation (objective): 19.800033569335938
Epoch: 5/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2258
validation/mse_mean: 58.9447
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3507
validation/objective_mean: 19.8100
validation/item_value_mean: 4.8402
train/rel_regret_mean: 0.3578
validation/abs_regret_mean: 10.6826
train/solver_calls_mean: 4435.6364
train/objective_mean: 18.2062
train/abs_regret_mean: 10.6101
train/loss_mean: -18.2062
train/sym_rel_regret_mean: 0.2313
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2262
validation/mse_mean: 58.9618
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3512
validation/objective_mean: 19.7863
validation/item_value_mean: 4.8374
train/rel_regret_mean: 0.3578
validation/abs_regret_mean: 10.7064
train/solver_calls_mean: 4435.6364
train/objective_mean: 18.2062
train/abs_regret_mean: 10.6101
train/loss_mean: -18.2062
train/sym_rel_regret_mean: 0.2313
Validation evaluation (objective): 19.667373657226562
New best validation evaluation (objective): 19.667373657226562 (was 19.750717163085938)
Epoch: 6/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2262
validation/mse_mean: 58.9618
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3512
validation/objective_mean: 19.7863
validation/item_value_mean: 4.8374
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7064
train/solver_calls_mean: 5285.6364
train/objective_mean: 18.1949
train/abs_regret_mean: 10.6212
train/loss_mean: -18.1949
train/sym_rel_regret_mean: 0.2315
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2264
validation/mse_mean: 58.9784
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3514
validation/objective_mean: 19.7748
validation/item_value_mean: 4.8339
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7178
train/solver_calls_mean: 5285.6364
train/objective_mean: 18.1949
train/abs_regret_mean: 10.6212
train/loss_mean: -18.1949
train/sym_rel_regret_mean: 0.2315
Validation evaluation (objective): 19.706317901611328
Epoch: 7/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2264
validation/mse_mean: 58.9784
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3874
validation/rel_regret_mean: 0.3514
validation/objective_mean: 19.7748
validation/item_value_mean: 4.8339
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7178
train/solver_calls_mean: 6135.6364
train/objective_mean: 18.1866
train/abs_regret_mean: 10.6287
train/loss_mean: -18.1866
train/sym_rel_regret_mean: 0.2315
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2265
validation/mse_mean: 58.9877
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3516
validation/objective_mean: 19.7569
validation/item_value_mean: 4.8310
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7357
train/solver_calls_mean: 6135.6364
train/objective_mean: 18.1866
train/abs_regret_mean: 10.6287
train/loss_mean: -18.1866
train/sym_rel_regret_mean: 0.2315
Validation evaluation (objective): 19.6317195892334
New best validation evaluation (objective): 19.6317195892334 (was 19.667373657226562)
Epoch: 8/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2265
validation/mse_mean: 58.9877
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3516
validation/objective_mean: 19.7569
validation/item_value_mean: 4.8310
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7357
train/solver_calls_mean: 6985.6364
train/objective_mean: 18.1817
train/abs_regret_mean: 10.6319
train/loss_mean: -18.1817
train/sym_rel_regret_mean: 0.2315
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2267
validation/mse_mean: 59.0002
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3517
validation/objective_mean: 19.7445
validation/item_value_mean: 4.8288
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7481
train/solver_calls_mean: 6985.6364
train/objective_mean: 18.1817
train/abs_regret_mean: 10.6319
train/loss_mean: -18.1817
train/sym_rel_regret_mean: 0.2315
Validation evaluation (objective): 19.64495277404785
Epoch: 9/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2267
validation/mse_mean: 59.0002
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3873
validation/rel_regret_mean: 0.3517
validation/objective_mean: 19.7445
validation/item_value_mean: 4.8288
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7481
train/solver_calls_mean: 7835.6364
train/objective_mean: 18.1775
train/abs_regret_mean: 10.6348
train/loss_mean: -18.1775
train/sym_rel_regret_mean: 0.2315
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2267
validation/mse_mean: 59.0202
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3872
validation/rel_regret_mean: 0.3518
validation/objective_mean: 19.7357
validation/item_value_mean: 4.8269
train/rel_regret_mean: 0.3580
validation/abs_regret_mean: 10.7569
train/solver_calls_mean: 7835.6364
train/objective_mean: 18.1775
train/abs_regret_mean: 10.6348
train/loss_mean: -18.1775
train/sym_rel_regret_mean: 0.2315
Validation evaluation (objective): 19.656370162963867
Epoch: 10/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2267
validation/mse_mean: 59.0202
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3872
validation/rel_regret_mean: 0.3518
validation/objective_mean: 19.7357
validation/item_value_mean: 4.8269
train/rel_regret_mean: 0.3582
validation/abs_regret_mean: 10.7569
train/solver_calls_mean: 8685.6364
train/objective_mean: 18.1685
train/abs_regret_mean: 10.6459
train/loss_mean: -18.1685
train/sym_rel_regret_mean: 0.2317
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2268
validation/mse_mean: 59.0537
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3872
validation/rel_regret_mean: 0.3519
validation/objective_mean: 19.7368
validation/item_value_mean: 4.8258
train/rel_regret_mean: 0.3582
validation/abs_regret_mean: 10.7558
train/solver_calls_mean: 8685.6364
train/objective_mean: 18.1685
train/abs_regret_mean: 10.6459
train/loss_mean: -18.1685
train/sym_rel_regret_mean: 0.2317
Validation evaluation (objective): 19.747798919677734
Epoch: 11/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2268
validation/mse_mean: 59.0537
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3872
validation/rel_regret_mean: 0.3519
validation/objective_mean: 19.7368
validation/item_value_mean: 4.8258
train/rel_regret_mean: 0.3586
validation/abs_regret_mean: 10.7558
train/solver_calls_mean: 9535.6364
train/objective_mean: 18.1551
train/abs_regret_mean: 10.6618
train/loss_mean: -18.1551
train/sym_rel_regret_mean: 0.2320
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2269
validation/mse_mean: 59.0883
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3871
validation/rel_regret_mean: 0.3521
validation/objective_mean: 19.7371
validation/item_value_mean: 4.8250
train/rel_regret_mean: 0.3586
validation/abs_regret_mean: 10.7555
train/solver_calls_mean: 9535.6364
train/objective_mean: 18.1551
train/abs_regret_mean: 10.6618
train/loss_mean: -18.1551
train/sym_rel_regret_mean: 0.2320
Validation evaluation (objective): 19.740800857543945
Epoch: 12/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2269
validation/mse_mean: 59.0883
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3871
validation/rel_regret_mean: 0.3521
validation/objective_mean: 19.7371
validation/item_value_mean: 4.8250
train/rel_regret_mean: 0.3589
validation/abs_regret_mean: 10.7555
train/solver_calls_mean: 10385.6364
train/objective_mean: 18.1422
train/abs_regret_mean: 10.6747
train/loss_mean: -18.1422
train/sym_rel_regret_mean: 0.2322
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2270
validation/mse_mean: 59.1152
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3870
validation/rel_regret_mean: 0.3522
validation/objective_mean: 19.7423
validation/item_value_mean: 4.8243
train/rel_regret_mean: 0.3589
validation/abs_regret_mean: 10.7503
train/solver_calls_mean: 10385.6364
train/objective_mean: 18.1422
train/abs_regret_mean: 10.6747
train/loss_mean: -18.1422
train/sym_rel_regret_mean: 0.2322
Validation evaluation (objective): 19.805011749267578
Epoch: 13/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2270
validation/mse_mean: 59.1152
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3870
validation/rel_regret_mean: 0.3522
validation/objective_mean: 19.7423
validation/item_value_mean: 4.8243
train/rel_regret_mean: 0.3592
validation/abs_regret_mean: 10.7503
train/solver_calls_mean: 11235.6364
train/objective_mean: 18.1321
train/abs_regret_mean: 10.6868
train/loss_mean: -18.1321
train/sym_rel_regret_mean: 0.2324
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2270
validation/mse_mean: 59.1336
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3522
validation/objective_mean: 19.7473
validation/item_value_mean: 4.8238
train/rel_regret_mean: 0.3592
validation/abs_regret_mean: 10.7453
train/solver_calls_mean: 11235.6364
train/objective_mean: 18.1321
train/abs_regret_mean: 10.6868
train/loss_mean: -18.1321
train/sym_rel_regret_mean: 0.2324
Validation evaluation (objective): 19.812023162841797
Epoch: 14/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2270
validation/mse_mean: 59.1336
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3522
validation/objective_mean: 19.7473
validation/item_value_mean: 4.8238
train/rel_regret_mean: 0.3595
validation/abs_regret_mean: 10.7453
train/solver_calls_mean: 12085.6364
train/objective_mean: 18.1265
train/abs_regret_mean: 10.6919
train/loss_mean: -18.1265
train/sym_rel_regret_mean: 0.2325
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2271
validation/mse_mean: 59.1571
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3524
validation/objective_mean: 19.7487
validation/item_value_mean: 4.8229
train/rel_regret_mean: 0.3595
validation/abs_regret_mean: 10.7439
train/solver_calls_mean: 12085.6364
train/objective_mean: 18.1265
train/abs_regret_mean: 10.6919
train/loss_mean: -18.1265
train/sym_rel_regret_mean: 0.2325
Validation evaluation (objective): 19.768678665161133
Epoch: 15/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2271
validation/mse_mean: 59.1571
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3524
validation/objective_mean: 19.7487
validation/item_value_mean: 4.8229
train/rel_regret_mean: 0.3597
validation/abs_regret_mean: 10.7439
train/solver_calls_mean: 12935.6364
train/objective_mean: 18.1187
train/abs_regret_mean: 10.6995
train/loss_mean: -18.1187
train/sym_rel_regret_mean: 0.2327
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2273
validation/mse_mean: 59.1896
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3525
validation/objective_mean: 19.7491
validation/item_value_mean: 4.8221
train/rel_regret_mean: 0.3597
validation/abs_regret_mean: 10.7435
train/solver_calls_mean: 12935.6364
train/objective_mean: 18.1187
train/abs_regret_mean: 10.6995
train/loss_mean: -18.1187
train/sym_rel_regret_mean: 0.2327
Validation evaluation (objective): 19.75446319580078
Epoch: 16/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2273
validation/mse_mean: 59.1896
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3869
validation/rel_regret_mean: 0.3525
validation/objective_mean: 19.7491
validation/item_value_mean: 4.8221
train/rel_regret_mean: 0.3600
validation/abs_regret_mean: 10.7435
train/solver_calls_mean: 13785.6364
train/objective_mean: 18.1117
train/abs_regret_mean: 10.7054
train/loss_mean: -18.1117
train/sym_rel_regret_mean: 0.2329
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2274
validation/mse_mean: 59.2194
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3527
validation/objective_mean: 19.7493
validation/item_value_mean: 4.8215
train/rel_regret_mean: 0.3600
validation/abs_regret_mean: 10.7433
train/solver_calls_mean: 13785.6364
train/objective_mean: 18.1117
train/abs_regret_mean: 10.7054
train/loss_mean: -18.1117
train/sym_rel_regret_mean: 0.2329
Validation evaluation (objective): 19.7526798248291
Epoch: 17/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2274
validation/mse_mean: 59.2194
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3527
validation/objective_mean: 19.7493
validation/item_value_mean: 4.8215
train/rel_regret_mean: 0.3602
validation/abs_regret_mean: 10.7433
train/solver_calls_mean: 14635.6364
train/objective_mean: 18.1049
train/abs_regret_mean: 10.7115
train/loss_mean: -18.1049
train/sym_rel_regret_mean: 0.2331
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2275
validation/mse_mean: 59.2440
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3528
validation/objective_mean: 19.7499
validation/item_value_mean: 4.8207
train/rel_regret_mean: 0.3602
validation/abs_regret_mean: 10.7427
train/solver_calls_mean: 14635.6364
train/objective_mean: 18.1049
train/abs_regret_mean: 10.7115
train/loss_mean: -18.1049
train/sym_rel_regret_mean: 0.2331
Validation evaluation (objective): 19.760772705078125
Epoch: 18/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2275
validation/mse_mean: 59.2440
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3528
validation/objective_mean: 19.7499
validation/item_value_mean: 4.8207
train/rel_regret_mean: 0.3604
validation/abs_regret_mean: 10.7427
train/solver_calls_mean: 15485.6364
train/objective_mean: 18.0972
train/abs_regret_mean: 10.7212
train/loss_mean: -18.0972
train/sym_rel_regret_mean: 0.2332
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2276
validation/mse_mean: 59.2682
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3530
validation/objective_mean: 19.7468
validation/item_value_mean: 4.8194
train/rel_regret_mean: 0.3604
validation/abs_regret_mean: 10.7458
train/solver_calls_mean: 15485.6364
train/objective_mean: 18.0972
train/abs_regret_mean: 10.7212
train/loss_mean: -18.0972
train/sym_rel_regret_mean: 0.2332
Validation evaluation (objective): 19.690181732177734
Epoch: 19/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2276
validation/mse_mean: 59.2682
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3868
validation/rel_regret_mean: 0.3530
validation/objective_mean: 19.7468
validation/item_value_mean: 4.8194
train/rel_regret_mean: 0.3606
validation/abs_regret_mean: 10.7458
train/solver_calls_mean: 16335.6364
train/objective_mean: 18.0865
train/abs_regret_mean: 10.7320
train/loss_mean: -18.0865
train/sym_rel_regret_mean: 0.2334
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2278
validation/mse_mean: 59.2929
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3867
validation/rel_regret_mean: 0.3532
validation/objective_mean: 19.7448
validation/item_value_mean: 4.8180
train/rel_regret_mean: 0.3606
validation/abs_regret_mean: 10.7479
train/solver_calls_mean: 16335.6364
train/objective_mean: 18.0865
train/abs_regret_mean: 10.7320
train/loss_mean: -18.0865
train/sym_rel_regret_mean: 0.2334
Validation evaluation (objective): 19.706037521362305
Epoch: 20/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2278
validation/mse_mean: 59.2929
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3867
validation/rel_regret_mean: 0.3532
validation/objective_mean: 19.7448
validation/item_value_mean: 4.8180
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7479
train/solver_calls_mean: 17185.6364
train/objective_mean: 18.0775
train/abs_regret_mean: 10.7422
train/loss_mean: -18.0775
train/sym_rel_regret_mean: 0.2335
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2279
validation/mse_mean: 59.3127
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3867
validation/rel_regret_mean: 0.3533
validation/objective_mean: 19.7429
validation/item_value_mean: 4.8169
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7498
train/solver_calls_mean: 17185.6364
train/objective_mean: 18.0775
train/abs_regret_mean: 10.7422
train/loss_mean: -18.0775
train/sym_rel_regret_mean: 0.2335
Validation evaluation (objective): 19.70473861694336
Epoch: 21/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2279
validation/mse_mean: 59.3127
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3867
validation/rel_regret_mean: 0.3533
validation/objective_mean: 19.7429
validation/item_value_mean: 4.8169
train/rel_regret_mean: 0.3610
validation/abs_regret_mean: 10.7498
train/solver_calls_mean: 18035.6364
train/objective_mean: 18.0666
train/abs_regret_mean: 10.7524
train/loss_mean: -18.0666
train/sym_rel_regret_mean: 0.2337
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2280
validation/mse_mean: 59.3349
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3535
validation/objective_mean: 19.7392
validation/item_value_mean: 4.8166
train/rel_regret_mean: 0.3610
validation/abs_regret_mean: 10.7534
train/solver_calls_mean: 18035.6364
train/objective_mean: 18.0666
train/abs_regret_mean: 10.7524
train/loss_mean: -18.0666
train/sym_rel_regret_mean: 0.2337
Validation evaluation (objective): 19.662982940673828
Epoch: 22/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2280
validation/mse_mean: 59.3349
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3535
validation/objective_mean: 19.7392
validation/item_value_mean: 4.8166
train/rel_regret_mean: 0.3611
validation/abs_regret_mean: 10.7534
train/solver_calls_mean: 18885.6364
train/objective_mean: 18.0599
train/abs_regret_mean: 10.7592
train/loss_mean: -18.0599
train/sym_rel_regret_mean: 0.2338
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2281
validation/mse_mean: 59.3524
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3537
validation/objective_mean: 19.7393
validation/item_value_mean: 4.8160
train/rel_regret_mean: 0.3611
validation/abs_regret_mean: 10.7533
train/solver_calls_mean: 18885.6364
train/objective_mean: 18.0599
train/abs_regret_mean: 10.7592
train/loss_mean: -18.0599
train/sym_rel_regret_mean: 0.2338
Validation evaluation (objective): 19.74137306213379
Epoch: 23/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2281
validation/mse_mean: 59.3524
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3537
validation/objective_mean: 19.7393
validation/item_value_mean: 4.8160
train/rel_regret_mean: 0.3613
validation/abs_regret_mean: 10.7533
train/solver_calls_mean: 19735.6364
train/objective_mean: 18.0550
train/abs_regret_mean: 10.7648
train/loss_mean: -18.0550
train/sym_rel_regret_mean: 0.2339
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2282
validation/mse_mean: 59.3635
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3538
validation/objective_mean: 19.7394
validation/item_value_mean: 4.8151
train/rel_regret_mean: 0.3613
validation/abs_regret_mean: 10.7532
train/solver_calls_mean: 19735.6364
train/objective_mean: 18.0550
train/abs_regret_mean: 10.7648
train/loss_mean: -18.0550
train/sym_rel_regret_mean: 0.2339
Validation evaluation (objective): 19.74138641357422
Epoch: 24/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2282
validation/mse_mean: 59.3635
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3866
validation/rel_regret_mean: 0.3538
validation/objective_mean: 19.7394
validation/item_value_mean: 4.8151
train/rel_regret_mean: 0.3614
validation/abs_regret_mean: 10.7532
train/solver_calls_mean: 20585.6364
train/objective_mean: 18.0509
train/abs_regret_mean: 10.7717
train/loss_mean: -18.0509
train/sym_rel_regret_mean: 0.2340
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2283
validation/mse_mean: 59.3736
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3539
validation/objective_mean: 19.7366
validation/item_value_mean: 4.8145
train/rel_regret_mean: 0.3614
validation/abs_regret_mean: 10.7560
train/solver_calls_mean: 20585.6364
train/objective_mean: 18.0509
train/abs_regret_mean: 10.7717
train/loss_mean: -18.0509
train/sym_rel_regret_mean: 0.2340
Validation evaluation (objective): 19.67044448852539
Epoch: 25/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2283
validation/mse_mean: 59.3736
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3539
validation/objective_mean: 19.7366
validation/item_value_mean: 4.8145
train/rel_regret_mean: 0.3615
validation/abs_regret_mean: 10.7560
train/solver_calls_mean: 21435.6364
train/objective_mean: 18.0466
train/abs_regret_mean: 10.7767
train/loss_mean: -18.0466
train/sym_rel_regret_mean: 0.2341
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2284
validation/mse_mean: 59.3830
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3541
validation/objective_mean: 19.7335
validation/item_value_mean: 4.8139
train/rel_regret_mean: 0.3615
validation/abs_regret_mean: 10.7591
train/solver_calls_mean: 21435.6364
train/objective_mean: 18.0466
train/abs_regret_mean: 10.7767
train/loss_mean: -18.0466
train/sym_rel_regret_mean: 0.2341
Validation evaluation (objective): 19.654279708862305
Epoch: 26/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2284
validation/mse_mean: 59.3830
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3541
validation/objective_mean: 19.7335
validation/item_value_mean: 4.8139
train/rel_regret_mean: 0.3616
validation/abs_regret_mean: 10.7591
train/solver_calls_mean: 22285.6364
train/objective_mean: 18.0407
train/abs_regret_mean: 10.7814
train/loss_mean: -18.0407
train/sym_rel_regret_mean: 0.2342
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2285
validation/mse_mean: 59.3912
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3542
validation/objective_mean: 19.7306
validation/item_value_mean: 4.8133
train/rel_regret_mean: 0.3616
validation/abs_regret_mean: 10.7620
train/solver_calls_mean: 22285.6364
train/objective_mean: 18.0407
train/abs_regret_mean: 10.7814
train/loss_mean: -18.0407
train/sym_rel_regret_mean: 0.2342
Validation evaluation (objective): 19.6569766998291
Epoch: 27/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2285
validation/mse_mean: 59.3912
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3542
validation/objective_mean: 19.7306
validation/item_value_mean: 4.8133
train/rel_regret_mean: 0.3617
validation/abs_regret_mean: 10.7620
train/solver_calls_mean: 23135.6364
train/objective_mean: 18.0389
train/abs_regret_mean: 10.7837
train/loss_mean: -18.0389
train/sym_rel_regret_mean: 0.2343
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2287
validation/mse_mean: 59.3953
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3544
validation/objective_mean: 19.7248
validation/item_value_mean: 4.8130
train/rel_regret_mean: 0.3617
validation/abs_regret_mean: 10.7678
train/solver_calls_mean: 23135.6364
train/objective_mean: 18.0389
train/abs_regret_mean: 10.7837
train/loss_mean: -18.0389
train/sym_rel_regret_mean: 0.2343
Validation evaluation (objective): 19.567773818969727
New best validation evaluation (objective): 19.567773818969727 (was 19.6317195892334)
Epoch: 28/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2287
validation/mse_mean: 59.3953
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3544
validation/objective_mean: 19.7248
validation/item_value_mean: 4.8130
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7678
train/solver_calls_mean: 23985.6364
train/objective_mean: 18.0387
train/abs_regret_mean: 10.7838
train/loss_mean: -18.0387
train/sym_rel_regret_mean: 0.2344
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2288
validation/mse_mean: 59.3959
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3546
validation/objective_mean: 19.7204
validation/item_value_mean: 4.8128
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7723
train/solver_calls_mean: 23985.6364
train/objective_mean: 18.0387
train/abs_regret_mean: 10.7838
train/loss_mean: -18.0387
train/sym_rel_regret_mean: 0.2344
Validation evaluation (objective): 19.594989776611328
Epoch: 29/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2288
validation/mse_mean: 59.3959
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3546
validation/objective_mean: 19.7204
validation/item_value_mean: 4.8128
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7723
train/solver_calls_mean: 24835.6364
train/objective_mean: 18.0387
train/abs_regret_mean: 10.7839
train/loss_mean: -18.0387
train/sym_rel_regret_mean: 0.2344
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2289
validation/mse_mean: 59.3966
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3547
validation/objective_mean: 19.7159
validation/item_value_mean: 4.8127
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7767
train/solver_calls_mean: 24835.6364
train/objective_mean: 18.0387
train/abs_regret_mean: 10.7839
train/loss_mean: -18.0387
train/sym_rel_regret_mean: 0.2344
Validation evaluation (objective): 19.58742904663086
Epoch: 30/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2289
validation/mse_mean: 59.3966
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3547
validation/objective_mean: 19.7159
validation/item_value_mean: 4.8127
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7767
train/solver_calls_mean: 25685.6364
train/objective_mean: 18.0385
train/abs_regret_mean: 10.7857
train/loss_mean: -18.0385
train/sym_rel_regret_mean: 0.2344
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2290
validation/mse_mean: 59.3988
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3549
validation/objective_mean: 19.7119
validation/item_value_mean: 4.8127
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7807
train/solver_calls_mean: 25685.6364
train/objective_mean: 18.0385
train/abs_regret_mean: 10.7857
train/loss_mean: -18.0385
train/sym_rel_regret_mean: 0.2344
Validation evaluation (objective): 19.59111976623535
Epoch: 31/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2290
validation/mse_mean: 59.3988
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3549
validation/objective_mean: 19.7119
validation/item_value_mean: 4.8127
train/rel_regret_mean: 0.3619
validation/abs_regret_mean: 10.7807
train/solver_calls_mean: 26535.6364
train/objective_mean: 18.0369
train/abs_regret_mean: 10.7868
train/loss_mean: -18.0369
train/sym_rel_regret_mean: 0.2345
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2291
validation/mse_mean: 59.4028
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3550
validation/objective_mean: 19.7075
validation/item_value_mean: 4.8126
train/rel_regret_mean: 0.3619
validation/abs_regret_mean: 10.7851
train/solver_calls_mean: 26535.6364
train/objective_mean: 18.0369
train/abs_regret_mean: 10.7868
train/loss_mean: -18.0369
train/sym_rel_regret_mean: 0.2345
Validation evaluation (objective): 19.57144546508789
Epoch: 32/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2291
validation/mse_mean: 59.4028
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3550
validation/objective_mean: 19.7075
validation/item_value_mean: 4.8126
train/rel_regret_mean: 0.3619
validation/abs_regret_mean: 10.7851
train/solver_calls_mean: 27385.6364
train/objective_mean: 18.0358
train/abs_regret_mean: 10.7885
train/loss_mean: -18.0358
train/sym_rel_regret_mean: 0.2345
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2292
validation/mse_mean: 59.4058
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3551
validation/objective_mean: 19.7047
validation/item_value_mean: 4.8125
train/rel_regret_mean: 0.3619
validation/abs_regret_mean: 10.7879
train/solver_calls_mean: 27385.6364
train/objective_mean: 18.0358
train/abs_regret_mean: 10.7885
train/loss_mean: -18.0358
train/sym_rel_regret_mean: 0.2345
Validation evaluation (objective): 19.615230560302734
Epoch: 33/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2292
validation/mse_mean: 59.4058
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3551
validation/objective_mean: 19.7047
validation/item_value_mean: 4.8125
train/rel_regret_mean: 0.3620
validation/abs_regret_mean: 10.7879
train/solver_calls_mean: 28235.6364
train/objective_mean: 18.0357
train/abs_regret_mean: 10.7886
train/loss_mean: -18.0357
train/sym_rel_regret_mean: 0.2346
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2292
validation/mse_mean: 59.4074
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3551
validation/objective_mean: 19.7032
validation/item_value_mean: 4.8125
train/rel_regret_mean: 0.3620
validation/abs_regret_mean: 10.7895
train/solver_calls_mean: 28235.6364
train/objective_mean: 18.0357
train/abs_regret_mean: 10.7886
train/loss_mean: -18.0357
train/sym_rel_regret_mean: 0.2346
Validation evaluation (objective): 19.65216064453125
Epoch: 34/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2292
validation/mse_mean: 59.4074
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3865
validation/rel_regret_mean: 0.3551
validation/objective_mean: 19.7032
validation/item_value_mean: 4.8125
train/rel_regret_mean: 0.3620
validation/abs_regret_mean: 10.7895
train/solver_calls_mean: 29085.6364
train/objective_mean: 18.0385
train/abs_regret_mean: 10.7855
train/loss_mean: -18.0385
train/sym_rel_regret_mean: 0.2346
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2291
validation/mse_mean: 59.3876
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3550
validation/objective_mean: 19.7120
validation/item_value_mean: 4.8132
train/rel_regret_mean: 0.3620
validation/abs_regret_mean: 10.7806
train/solver_calls_mean: 29085.6364
train/objective_mean: 18.0385
train/abs_regret_mean: 10.7855
train/loss_mean: -18.0385
train/sym_rel_regret_mean: 0.2346
Validation evaluation (objective): 20.01394271850586
Epoch: 35/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2291
validation/mse_mean: 59.3876
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3550
validation/objective_mean: 19.7120
validation/item_value_mean: 4.8132
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7806
train/solver_calls_mean: 29935.6364
train/objective_mean: 18.0491
train/abs_regret_mean: 10.7745
train/loss_mean: -18.0491
train/sym_rel_regret_mean: 0.2345
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2290
validation/mse_mean: 59.3637
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3548
validation/objective_mean: 19.7191
validation/item_value_mean: 4.8142
train/rel_regret_mean: 0.3618
validation/abs_regret_mean: 10.7735
train/solver_calls_mean: 29935.6364
train/objective_mean: 18.0491
train/abs_regret_mean: 10.7745
train/loss_mean: -18.0491
train/sym_rel_regret_mean: 0.2345
Validation evaluation (objective): 19.96627426147461
Epoch: 36/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2290
validation/mse_mean: 59.3637
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3548
validation/objective_mean: 19.7191
validation/item_value_mean: 4.8142
train/rel_regret_mean: 0.3617
validation/abs_regret_mean: 10.7735
train/solver_calls_mean: 30785.6364
train/objective_mean: 18.0599
train/abs_regret_mean: 10.7642
train/loss_mean: -18.0599
train/sym_rel_regret_mean: 0.2344
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2288
validation/mse_mean: 59.3405
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3547
validation/objective_mean: 19.7265
validation/item_value_mean: 4.8151
train/rel_regret_mean: 0.3617
validation/abs_regret_mean: 10.7661
train/solver_calls_mean: 30785.6364
train/objective_mean: 18.0599
train/abs_regret_mean: 10.7642
train/loss_mean: -18.0599
train/sym_rel_regret_mean: 0.2344
Validation evaluation (objective): 19.991878509521484
Epoch: 37/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2288
validation/mse_mean: 59.3405
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3547
validation/objective_mean: 19.7265
validation/item_value_mean: 4.8151
train/rel_regret_mean: 0.3615
validation/abs_regret_mean: 10.7661
train/solver_calls_mean: 31635.6364
train/objective_mean: 18.0701
train/abs_regret_mean: 10.7551
train/loss_mean: -18.0701
train/sym_rel_regret_mean: 0.2343
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2287
validation/mse_mean: 59.3183
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3545
validation/objective_mean: 19.7348
validation/item_value_mean: 4.8160
train/rel_regret_mean: 0.3615
validation/abs_regret_mean: 10.7578
train/solver_calls_mean: 31635.6364
train/objective_mean: 18.0701
train/abs_regret_mean: 10.7551
train/loss_mean: -18.0701
train/sym_rel_regret_mean: 0.2343
Validation evaluation (objective): 20.042150497436523
Epoch: 38/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2287
validation/mse_mean: 59.3183
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3545
validation/objective_mean: 19.7348
validation/item_value_mean: 4.8160
train/rel_regret_mean: 0.3614
validation/abs_regret_mean: 10.7578
train/solver_calls_mean: 32485.6364
train/objective_mean: 18.0798
train/abs_regret_mean: 10.7454
train/loss_mean: -18.0798
train/sym_rel_regret_mean: 0.2342
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2286
validation/mse_mean: 59.2955
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3543
validation/objective_mean: 19.7437
validation/item_value_mean: 4.8167
train/rel_regret_mean: 0.3614
validation/abs_regret_mean: 10.7489
train/solver_calls_mean: 32485.6364
train/objective_mean: 18.0798
train/abs_regret_mean: 10.7454
train/loss_mean: -18.0798
train/sym_rel_regret_mean: 0.2342
Validation evaluation (objective): 20.08382797241211
Epoch: 39/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2286
validation/mse_mean: 59.2955
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3543
validation/objective_mean: 19.7437
validation/item_value_mean: 4.8167
train/rel_regret_mean: 0.3613
validation/abs_regret_mean: 10.7489
train/solver_calls_mean: 33335.6364
train/objective_mean: 18.0889
train/abs_regret_mean: 10.7357
train/loss_mean: -18.0889
train/sym_rel_regret_mean: 0.2341
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2284
validation/mse_mean: 59.2744
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3542
validation/objective_mean: 19.7520
validation/item_value_mean: 4.8175
train/rel_regret_mean: 0.3613
validation/abs_regret_mean: 10.7406
train/solver_calls_mean: 33335.6364
train/objective_mean: 18.0889
train/abs_regret_mean: 10.7357
train/loss_mean: -18.0889
train/sym_rel_regret_mean: 0.2341
Validation evaluation (objective): 20.074636459350586
Epoch: 40/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2284
validation/mse_mean: 59.2744
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3542
validation/objective_mean: 19.7520
validation/item_value_mean: 4.8175
train/rel_regret_mean: 0.3612
validation/abs_regret_mean: 10.7406
train/solver_calls_mean: 34185.6364
train/objective_mean: 18.0964
train/abs_regret_mean: 10.7284
train/loss_mean: -18.0964
train/sym_rel_regret_mean: 0.2340
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2283
validation/mse_mean: 59.2563
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3540
validation/objective_mean: 19.7594
validation/item_value_mean: 4.8183
train/rel_regret_mean: 0.3612
validation/abs_regret_mean: 10.7333
train/solver_calls_mean: 34185.6364
train/objective_mean: 18.0964
train/abs_regret_mean: 10.7284
train/loss_mean: -18.0964
train/sym_rel_regret_mean: 0.2340
Validation evaluation (objective): 20.05381965637207
Epoch: 41/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2283
validation/mse_mean: 59.2563
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3540
validation/objective_mean: 19.7594
validation/item_value_mean: 4.8183
train/rel_regret_mean: 0.3611
validation/abs_regret_mean: 10.7333
train/solver_calls_mean: 35035.6364
train/objective_mean: 18.1034
train/abs_regret_mean: 10.7209
train/loss_mean: -18.1034
train/sym_rel_regret_mean: 0.2340
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2282
validation/mse_mean: 59.2391
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3539
validation/objective_mean: 19.7665
validation/item_value_mean: 4.8190
train/rel_regret_mean: 0.3611
validation/abs_regret_mean: 10.7261
train/solver_calls_mean: 35035.6364
train/objective_mean: 18.1034
train/abs_regret_mean: 10.7209
train/loss_mean: -18.1034
train/sym_rel_regret_mean: 0.2340
Validation evaluation (objective): 20.059972763061523
Epoch: 42/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2282
validation/mse_mean: 59.2391
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3539
validation/objective_mean: 19.7665
validation/item_value_mean: 4.8190
train/rel_regret_mean: 0.3610
validation/abs_regret_mean: 10.7261
train/solver_calls_mean: 35885.6364
train/objective_mean: 18.1103
train/abs_regret_mean: 10.7138
train/loss_mean: -18.1103
train/sym_rel_regret_mean: 0.2339
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2281
validation/mse_mean: 59.2235
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3538
validation/objective_mean: 19.7730
validation/item_value_mean: 4.8195
train/rel_regret_mean: 0.3610
validation/abs_regret_mean: 10.7196
train/solver_calls_mean: 35885.6364
train/objective_mean: 18.1103
train/abs_regret_mean: 10.7138
train/loss_mean: -18.1103
train/sym_rel_regret_mean: 0.2339
Validation evaluation (objective): 20.04701042175293
Epoch: 43/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2281
validation/mse_mean: 59.2235
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3538
validation/objective_mean: 19.7730
validation/item_value_mean: 4.8195
train/rel_regret_mean: 0.3609
validation/abs_regret_mean: 10.7196
train/solver_calls_mean: 36735.6364
train/objective_mean: 18.1167
train/abs_regret_mean: 10.7074
train/loss_mean: -18.1167
train/sym_rel_regret_mean: 0.2338
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2280
validation/mse_mean: 59.2086
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3537
validation/objective_mean: 19.7790
validation/item_value_mean: 4.8199
train/rel_regret_mean: 0.3609
validation/abs_regret_mean: 10.7136
train/solver_calls_mean: 36735.6364
train/objective_mean: 18.1167
train/abs_regret_mean: 10.7074
train/loss_mean: -18.1167
train/sym_rel_regret_mean: 0.2338
Validation evaluation (objective): 20.036598205566406
Epoch: 44/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2280
validation/mse_mean: 59.2086
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3537
validation/objective_mean: 19.7790
validation/item_value_mean: 4.8199
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7136
train/solver_calls_mean: 37585.6364
train/objective_mean: 18.1231
train/abs_regret_mean: 10.7008
train/loss_mean: -18.1231
train/sym_rel_regret_mean: 0.2338
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2279
validation/mse_mean: 59.1936
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3535
validation/objective_mean: 19.7837
validation/item_value_mean: 4.8204
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7089
train/solver_calls_mean: 37585.6364
train/objective_mean: 18.1231
train/abs_regret_mean: 10.7008
train/loss_mean: -18.1231
train/sym_rel_regret_mean: 0.2338
Validation evaluation (objective): 19.9888973236084
Epoch: 45/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2279
validation/mse_mean: 59.1936
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3535
validation/objective_mean: 19.7837
validation/item_value_mean: 4.8204
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7089
train/solver_calls_mean: 38435.6364
train/objective_mean: 18.1292
train/abs_regret_mean: 10.6942
train/loss_mean: -18.1292
train/sym_rel_regret_mean: 0.2337
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2278
validation/mse_mean: 59.1778
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3534
validation/objective_mean: 19.7907
validation/item_value_mean: 4.8209
train/rel_regret_mean: 0.3608
validation/abs_regret_mean: 10.7019
train/solver_calls_mean: 38435.6364
train/objective_mean: 18.1292
train/abs_regret_mean: 10.6942
train/loss_mean: -18.1292
train/sym_rel_regret_mean: 0.2337
Validation evaluation (objective): 20.10559844970703
Epoch: 46/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2278
validation/mse_mean: 59.1778
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3534
validation/objective_mean: 19.7907
validation/item_value_mean: 4.8209
train/rel_regret_mean: 0.3607
validation/abs_regret_mean: 10.7019
train/solver_calls_mean: 39285.6364
train/objective_mean: 18.1349
train/abs_regret_mean: 10.6880
train/loss_mean: -18.1349
train/sym_rel_regret_mean: 0.2336
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2277
validation/mse_mean: 59.1628
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3533
validation/objective_mean: 19.7965
validation/item_value_mean: 4.8214
train/rel_regret_mean: 0.3607
validation/abs_regret_mean: 10.6961
train/solver_calls_mean: 39285.6364
train/objective_mean: 18.1349
train/abs_regret_mean: 10.6880
train/loss_mean: -18.1349
train/sym_rel_regret_mean: 0.2336
Validation evaluation (objective): 20.06472396850586
Epoch: 47/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2277
validation/mse_mean: 59.1628
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3533
validation/objective_mean: 19.7965
validation/item_value_mean: 4.8214
train/rel_regret_mean: 0.3605
validation/abs_regret_mean: 10.6961
train/solver_calls_mean: 40135.6364
train/objective_mean: 18.1419
train/abs_regret_mean: 10.6808
train/loss_mean: -18.1419
train/sym_rel_regret_mean: 0.2335
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2276
validation/mse_mean: 59.1382
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3531
validation/objective_mean: 19.8041
validation/item_value_mean: 4.8213
train/rel_regret_mean: 0.3605
validation/abs_regret_mean: 10.6885
train/solver_calls_mean: 40135.6364
train/objective_mean: 18.1419
train/abs_regret_mean: 10.6808
train/loss_mean: -18.1419
train/sym_rel_regret_mean: 0.2335
Validation evaluation (objective): 20.160640716552734
Epoch: 48/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2276
validation/mse_mean: 59.1382
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3531
validation/objective_mean: 19.8041
validation/item_value_mean: 4.8213
train/rel_regret_mean: 0.3603
validation/abs_regret_mean: 10.6885
train/solver_calls_mean: 40985.6364
train/objective_mean: 18.1515
train/abs_regret_mean: 10.6711
train/loss_mean: -18.1515
train/sym_rel_regret_mean: 0.2334
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2274
validation/mse_mean: 59.1117
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3529
validation/objective_mean: 19.8122
validation/item_value_mean: 4.8212
train/rel_regret_mean: 0.3603
validation/abs_regret_mean: 10.6804
train/solver_calls_mean: 40985.6364
train/objective_mean: 18.1515
train/abs_regret_mean: 10.6711
train/loss_mean: -18.1515
train/sym_rel_regret_mean: 0.2334
Validation evaluation (objective): 20.19905662536621
Epoch: 49/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2274
validation/mse_mean: 59.1117
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3529
validation/objective_mean: 19.8122
validation/item_value_mean: 4.8212
train/rel_regret_mean: 0.3601
validation/abs_regret_mean: 10.6804
train/solver_calls_mean: 41835.6364
train/objective_mean: 18.1609
train/abs_regret_mean: 10.6619
train/loss_mean: -18.1609
train/sym_rel_regret_mean: 0.2332
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2273
validation/mse_mean: 59.0847
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3527
validation/objective_mean: 19.8204
validation/item_value_mean: 4.8211
train/rel_regret_mean: 0.3601
validation/abs_regret_mean: 10.6722
train/solver_calls_mean: 41835.6364
train/objective_mean: 18.1609
train/abs_regret_mean: 10.6619
train/loss_mean: -18.1609
train/sym_rel_regret_mean: 0.2332
Validation evaluation (objective): 20.225801467895508
Epoch: 50/50
Problem mode set to: train
Epoch Results:
validation/sym_rel_regret_mean: 0.2273
validation/mse_mean: 59.0847
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3527
validation/objective_mean: 19.8204
validation/item_value_mean: 4.8211
train/rel_regret_mean: 0.3599
validation/abs_regret_mean: 10.6722
train/solver_calls_mean: 42685.6364
train/objective_mean: 18.1688
train/abs_regret_mean: 10.6538
train/loss_mean: -18.1688
train/sym_rel_regret_mean: 0.2331
Problem mode set to: validation
Epoch Results:
validation/sym_rel_regret_mean: 0.2271
validation/mse_mean: 59.0590
train/grad_norm_mean: 0.0000
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3525
validation/objective_mean: 19.8294
validation/item_value_mean: 4.8208
train/rel_regret_mean: 0.3599
validation/abs_regret_mean: 10.6632
train/solver_calls_mean: 42685.6364
train/objective_mean: 18.1688
train/abs_regret_mean: 10.6538
train/loss_mean: -18.1688
train/sym_rel_regret_mean: 0.2331
Validation evaluation (objective): 20.27566909790039
Training finished. Evaluating on the test set...
Problem mode set to: test
Epoch Results:
validation/mse_mean: 59.0590
test/rel_regret_mean: 0.3658
train/rel_regret_mean: 0.3599
validation/objective_mean: 19.8294
train/objective_mean: 18.1688
test/objective_mean: 18.3687
test/mse_mean: 67.1335
train/loss_mean: -18.1688
validation/sym_rel_regret_mean: 0.2271
validation/select_item_mean: 0.3864
validation/rel_regret_mean: 0.3525
validation/item_value_mean: 4.8208
train/abs_regret_mean: 10.6538
test/sym_rel_regret_mean: 0.2381
test/item_value_mean: 4.8012
test/abs_regret_mean: 11.2857
validation/abs_regret_mean: 10.6632
train/grad_norm_mean: 0.0000
test/select_item_mean: 0.3838
train/solver_calls_mean: 42685.6364
train/sym_rel_regret_mean: 0.2331
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float32(19.567774)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">metric</span> <span class="o">=</span> <span class="s2">&quot;train/objective_mean&quot;</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">runner</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">epoch_metrics_list</span> <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>

<span class="n">metric</span> <span class="o">=</span> <span class="s2">&quot;validation/objective_mean&quot;</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">runner</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">epoch_metrics_list</span> <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">metric</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_1_Solving_a_contextual_knapsack_problem_13_0.png" src="../_images/examples_1_Solving_a_contextual_knapsack_problem_13_0.png" />
</div>
</div>
<h3 id="References">References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h3>
<p>[1] Akshay Agrawal, Brandon Amos, Shane Barratt, Stephen Boyd, Steven Diamond, and J Zico Kolter. Differentiable convex optimization layers. Advances in neural information processing systems, 32, 2019. doi:<a class="reference external" href="https://doi.org/10.48550/arXiv.1910.12430">10.48550/arXiv.1910.12430</a>.</p>
<p>[2] Bo Tang and Elias B. Khalil. Pyepo: a pytorch-based end-to-end predict-then-optimize library for linear and integer programming. Mathematical Programming Computation, 16(3):297–335, 2024. doi:<a class="reference external" href="https://doi.org/10.48550/arXiv.1910.12430">10.1007/s12532-024-00255-x</a>.</p>







  
  






                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2025 - 2025, Noah Schutte, Kim van den Houten, Grigorii Veviurko.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.top"], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
      
        <script src="../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>